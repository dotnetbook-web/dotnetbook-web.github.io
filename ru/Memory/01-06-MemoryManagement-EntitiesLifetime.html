<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.NET Platform Architecture</title>
</head>
<body>
    <link rel="stylesheet" href="../../res/bootstrap.css">
    <link rel="stylesheet" href="../../res/awesome.css">
    <style>

body {
    font-family: PF Regal,Georgia,serif;
    font-size: 16pt;
    font-weight: 300;
    padding-top: 4em;
    background-color: #fdfdfd;
}

.book-title-container {
    width: 100%;
    text-align: center;
    margin: 73px 0 110px 0;
}

.book-title {
    font-size: 57pt;
    margin: 50px 0 70px 0;
    user-select: none;
}
.book-part-title-block {
    display: inline-block;
}
.book-part-title {
    font-size: 21pt;
    color: #656ab6;
    margin: 0 7px;
}

.book-part-title:hover {
    box-shadow: inset 0 -1px #007bff;
    text-decoration: none;
}

.book-superheading-title {
    font-size: 15pt;
    margin: 0 7px;
    color: #656ab6;
}

.article-container
{
    width: 62%;
}

strong {
    font-weight: 500;
}

p, li {
    margin: 0 0 1em;
    line-height: 1.5em;
    font-family: inherit;
}

ol, li {
    margin-top: 1em;
    margin-bottom: 1em;
}

ol {
    padding-left: 1.21em;
}

ul  {
    padding-left: 1em;
}

ol li, ul li {
    padding-left: 0.5em;	
    font-family: inherit;
    text-align: justify;
}

table {
    margin: 30px 0;
    width: 100%;
}

thead {
    background-color: aliceblue;
}

table th {
    font-weight: 400;
}

table td, table th {
    padding: 7px;
    border-top: solid darkgrey 1px;
    border-bottom: solid darkgrey 1px;
    border-right: dotted darkgray 1px;
    border-left: dotted darkgray 1px;
    font-size: smaller;
}

code, *[class*='lang-'] span, *[class*='lang-'] pre {
    font-family: JB Mono, monospace !important;
}

*[class*='lang-'] {
    padding: 0px 0px 25px 0px;
    font-size: 0.75em;
}


*[class*='lang-'] > div, pre > code {
    border-left-color: #eee;
    border-left-style: dotted;
    border-left-width: 3px;
    padding-left: 25px;
    display: block;
    padding-top: 20px;
    padding-bottom: 20px;
}

*[class*='lang-'] > div pre, pre > code pre {
    margin-bottom: 0;
}

p code:not(.highlight), li code:not(.highlight) {
    font-size: 0.7em;
    border: gainsboro;
    border-width: 1px;
    border-style: solid;
    padding: 3px;
    color: darkslateblue;
}

code.highlight {
    font-family: inherit !important;
    font-size: inherit;
    font-weight: inherit;
    color: inherit;
}

p code.highlight, li code.highlight {
    padding: 4px;
    background-color: #ffffa1;
}

.wide {
    width:140%;
}

p a, li a {
    text-decoration: none;
    color: inherit;
    box-shadow: inset 0 -1px #b88b59;
}

p a:hover, li a:hover {
    text-decoration: none;
    color: inherit;
    box-shadow: inset 0 -1px #0056b3;
}

blockquote h5 {
    background-color: aquamarine;
    margin: 16px 0 16px -20px;
    padding: 15px 30px 15px;
}

p img {
    width: 95%;
}

blockquote 
{
    padding-left: 0.4em;
    border-left: 0.5em solid rgba(0,0,0,.08);
    font-style: italic;
}

blockquote.big-quote, 
blockquote.breadcrumbs 
{
    background-color: transparent;
    padding: 0;
    border-left: none;
    font-style: normal;
}

blockquote.breadcrumbs, blockquote.breadcrumbs  p
{
    margin: 0;
    padding: 0;
}

blockquote p {
    padding: 1em 1em 1em 0.6em;
    font-family: inherit;
}

blockquote p code {
    font-family: consolas, monospace;
    font-size: 17px;
    padding: 4px 6px;
}

blockquote p em {
    font-weight: 400;
}

blockquote.big-quote > p {
    margin: 0.7em 0 0.7em 0;
    font-family: Charter;
    font-size: 2.5em;
    padding: 0;
    width: 130%;
    line-height: 1em;
}

h1, h2, h3, h4, h5, h6 {
    margin: 0;
    padding: 0;
    font-weight: 400;
    font-family: inherit;
}

h1 {
    font-size: 2.2em;
    font-family: Charter,Georgia,serif;
    font-weight: 300;
    margin: 1.8em 0 1.8em 0;
    text-align: center;
    width: 140%;
}

h2 {
    margin-top: 2em;
    font-family: Charter,Arial,Helvetica Neue,sans-serif;
    font-size: 1.25em;
    width: 70%;
}

h3 {
    margin: 30px 0 15px 0;
    font-size: 17pt;
    font-weight: 500;
}

h4 {
    margin: 20px 0 10px 0;
    font-size: 16pt;
    font-weight: 500;
    font-style: italic;
}

/* Sidenotes */

.aside-container {
    position: relative;
}
.aside-container p {
    position: relative;
    top: 9px;
}

.aside-container > .aside-side-container {
    display: block;
    position: absolute;
    top: 12px;
    left: 96%;
    width: 34%;
    font-size: 12pt;
    line-height: 20px;
    margin-left: 100px;
    z-index: 1000;
}

.aside-container > .aside-side-container p {
    line-height: 24px;
    font-size: 13pt;
    margin: 0 0 13px 0;
}

.side-regular-block p {
    top: 0;
}

/* Music side player */
.aside-side-container .music-player {
    width: 100%;
    height: 400px;
}

/* media block after h1 */
.aside-container h1 + .aside-side-container.side-media-block h2 {
    margin: 7em 0 1em 0;
    font-family: Proxima Nova,Arial,Helvetica Neue,sans-serif;
    font-weight: 600;
}

.aside-side-container > li {
    display: block;
    font-family: Charter;
}

.aside-side-container > li ul, .aside-side-container > li ol {
    padding-left: 30px;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.aside-side-container > li li {
    padding-left: 6px;
    margin: 0 0 6px;
    line-height: 22px;

    font-family: Charter;
}

.aside-side-container p {
    line-height: 25px;
    font-size: 13pt;
    margin: 0 0 15px 0;
}

.aside-side-container blockquote {
    border: aliceblue;
    border-left-style: solid;
}

/* Paragraphs numbering */
.paragraph-container {
    position: relative;
}
.paragraph-container p {
    position: relative;
    top: 9px;
}

.paragraph-container p, .aside-container > p {
    text-align: justify;
}

.paragraph-container > .paragraph-left-side, .paragraph-container > .paragraph-right-side  {
    font-family: JB Mono, consolas;
    display: block;
    position: absolute;
    top: 17px;
    font-size: 10pt;
    line-height: 20px;
    color: #86abc473;
    z-index: 1000;
}
.paragraph-container > .paragraph-left-side {
    display: none;
    left: -2.1cm;
    width: 35px;
    user-select: none;
}

.paragraph-container > .paragraph-right-side  {
    display: none;
    left: 100%;
    width: 35px;
    padding-left: 45px;
    user-select: none;
}

.article-container
{
    width: 70%;
}

/* X_MENU */
.menu-title {
    text-align: center;
    margin: 35px 50px 35px 50px;
    font-size: 24pt;
    font-family: Charter;
}

.menu-container ol {
    margin: 0;
    padding: 0;
}

.menu-container ol li {
    margin: 0;
    padding: 0;
}

.header {
    height: 4em;
    background-color: white;
    position: relative;
    z-index: 1500;
    width: 100%;
    display: flex;
    justify-content: space-between;
    transition: all 1s;
    top: 0;
    box-shadow: 1px -4px 20px rgba(0, 0, 0, .1);
}

.fixed {
    position: fixed !important;
}

.header > .menu {
    pointer-events: auto;
    float: right;
    height: 40px;
    font-family: Charter, 'Helvetica Neue', Arial, sans-serif;
    font-size: 1em;
    color: #fff;
    margin-top:40px;
    margin-right:40px;
}

.menu a {
    color: #fff;
}
.menu a:hover {
    text-decoration: none;
    color: #fff;
}

#menu__toggle {
    opacity: 0;
}

#menu__toggle:checked ~ .menu__btn > span {
    transform: rotate(45deg);
}
#menu__toggle:checked ~ .menu__btn > span::before {
    top: 0;
    transform: rotate(0);
    background-color: black
}
#menu__toggle:checked ~ .menu__btn > span::after {
    top: 0;
    transform: rotate(90deg);
    background-color: black
}
#menu__toggle:checked ~ .menu__box {
    visibility: visible;
    right: 0;
}

.menu__btn {
    display: flex;
    align-items: center;
    position: fixed;
    top: 0;
    right: 0;
    width: 1.4em;
    height: 1.0em;
    cursor: pointer;
    z-index: 1;
    margin: 1.5em;
}

.menu__btn > span,
.menu__btn > span::before,
.menu__btn > span::after {
    display: block;
    position: absolute;

    width: 100%;
    height: 1px;

    background-color: black;

    transition-duration: .25s;
}
.menu__btn > span::before {
    content: '';
    top: -8px;
}
.menu__btn > span::after {
    content: '';
    top: 8px;
}

.menu__box {
    display: block;
    position: fixed;
    visibility: hidden;
    top: 0;
    right: -100%;

    width: 100%;
    height: 100%;

    margin: 0;
    padding: 80px 0;

    list-style: none;

    background-color: white;
    box-shadow: 1px 0px 6px rgba(0, 0, 0, .2);

    transition-duration: .25s;
}
.menu__box li a:hover {
    text-decoration: none;
    color: inherit;
}
.menu__list {
    margin: 0 2em 0 2em;
}
.menu__list li {
    text-align: left;
}

/* X_HEADER */

.conflogo {
    height: 1.2em;
    margin: 0.95em 0 0 1em;
    font-size: 1.5em;
    font-family: Charter;
}

.invisible {
    display: none;
}

.header > .menu > div {
    display: inline;
    margin-left: 10px;
    margin-right: 10px;
}

.menu__header_current
{
    text-align: center;
    font-size: 2em;
    margin: 1em 0 1em 0;
}

.menu__header_total
{
    text-align: center;
    font-size: 2em;
    margin: 1.5em 0 1em 0;
}

/* X_FOOTER */

footer {
    margin-top: 2em;
    background-color: black;
    height: 4em;
}

.footer-container {
    height: 100%;
}

.footer-wrap {
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 0;
}

.footer-wrap p {
    margin: 0;
    padding: 0px;
    line-height: 1em;
}

.footer-container img {
    height: 1.6em;
    margin-top: auto;
    margin-bottom: auto;
}

.footer-link {
    color: white;
    margin: 0 7px;
    font-size: 1em;
    box-shadow: none;
}

.footer-link:hover {
    color: salmon;
    box-shadow: none;
}

/* MEDIA */
/* XXL */
@media (min-width: 1601px) {
    .book-container
    {
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
    }
}

/* XL */
@media (max-width: 1600px) {
    .book-container
    {
        margin-left: 4cm;
        margin-right: 4cm;
    }
}

/* LG */
@media (max-width: 1400px) {
    .book-container
    {
        margin-left: 4cm;
        margin-right: 4cm;
    }

    blockquote.big-quote > p {
        font-size: 2em;
    }
}

/* > MD */
@media (min-width: 992px) {
    .hamburger-menu {
        display: none;
    }
}

/* MD */
@media (max-width: 991px) {
    
    h2 {
        width:80%;
    }

    .book-container
    {
        margin-left: 3cm;
        margin-right: 3cm;
    }
    
    .book-title-container {
        margin: 73px 0 110px 0;
    }

    .book-title {
        font-size: 50pt;
        margin: 50px 0 70px 0;
    }

    .book-part-title {
        font-size: 19pt;
    }

    .book-part-title:hover {
        box-shadow: inset 0 -1px #007bff;
    }

    .book-superheading-title {
        font-size: 15pt;
    }                                     

    .article-container, h1 {
        width: 100%;
    }

    .aside-container p {
        top: 0;
    }

    .aside-container h1 + .aside-side-container.side-media-block h2 {
        display: none;
    }

    .wide {
        width: 100%;     
    }

    .side-regular-block {
        margin: 40px 10px;
        padding-left: 100px;
    }
    .aside-side-container .music-player {
        width: 100%;
        height: 100px;
    }
    .aside-side-container.side-media-block {
        padding: 17px 0;
    }
    .aside-side-container.side-media-block h2 {
        margin-top: 20px;
        font-size: 13pt;
        border: none;
    }

    .aside-container > .aside-side-container
    {
        position: relative;
        top: auto;
        left: auto;
        width: auto;
        height: auto;
        margin: 0;
        padding: 17px;
    }

    blockquote.big-quote > p {
        width: 100%;
        font-size: 2em;
    }

    .paragraph-container .paragraph-left-side {
        left: -55px;
    }

    body {
        font-size: 15pt;
    }

    p code:not(.highlight), li code:not(.highlight) {
        font-size: 11pt;
    }

    p, li {
        line-height: 30px;
    }
    
    li {
        margin: 0 0 10px 0;
    }

    .side-regular-block {
        border-radius: 5px;
        background-image: linear-gradient(180deg,hsla(0,0%,100%,0) 60%,#fff),linear-gradient(70deg,#dbedff 32%,#ebfff0);
        padding: 22px;
    }    
}

/* Smartphone horizontal - SM */
@media (max-width: 767px) {
    .book-title-container {
        margin: 73px 0 110px 0;
    }

    h1 {
        margin: 1.8em 0em 1.8em 0.3em;
    }

    .book-title {
        font-size: 40pt;
        margin: 50px 0 70px 0;
    }

    .book-part-title {
        font-size: 19pt;
    }

    .book-part-title:hover {
        box-shadow: inset 0 -1px #007bff;
    }

    .book-superheading-title {
        font-size: 17pt;
    }

    .book-container {
        margin: 0 2.5cm;
    }
    ul {
        margin-left: 30px;
        margin-right: 30px;
        padding-left: 25px;
    }
    .paragraph-container > .paragraph-left-side {
	    display: block;
        top: 14px;
        font-size: 9pt;
    }
    .paragraph-container > .paragraph-right-side {
    	display: block;
        padding-left: 40px;
        top: 14px;
        font-size: 9pt;
    }
    .footer-container img {
        height: 1.3em;
    } 
}

@media (max-width: 630px) {
    .book-container {
        margin: 0 1.5cm;
    }
    .paragraph-container > .paragraph-left-side {
        left: -33px;
    }
    .paragraph-container > .paragraph-right-side {
        padding-left: 24px;
    }
}
/* Smartphone - XS */
@media (max-width: 575px) {
    .book-container {
        margin: 0 50px 0 30px;
    }
    ul {
        margin: 0;
        padding-left: 20px;
    }

    body {
        font-size: 13pt;
    }

    p code:not(.highlight), li code:not(.highlight) 
    {
        font-size: 10pt;
        padding: 3px;
    }
   
    p, li {
        line-height: 24px;
    }    
    
    .paragraph-container .paragraph-left-side 
    {
        display: none;        
    }
    .paragraph-container .paragraph-right-side 
    {
        padding-left: 21px;
        top: 14px;
	    font-size: 8pt;
    }
    .footer-container img {
        height: 1em;
    } 
    .menu__list {
        margin: 0 1em 0 1em;
    }
}

/* Fonts */

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-Bold.eot');
    src: local('../../res/fonts/PFRegalTextPro-Bold'),
        url('../../res/fonts/PFRegalTextPro-Bold.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-Bold.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-Bold.ttf') format('truetype');
    font-weight: bold;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-Medium.eot');
    src: local('../../res/fonts/PFRegalTextPro-Medium'),
        url('../../res/fonts/PFRegalTextPro-Medium.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-Medium.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-Medium.ttf') format('truetype');
    font-weight: 500;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-BlackItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-BlackItalic'),
        url('../../res/fonts/PFRegalTextPro-BlackItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-BlackItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-BlackItalic.ttf') format('truetype');
    font-weight: 900;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-Black.eot');
    src: local('../../res/fonts/PFRegalTextPro-Black'),
        url('../../res/fonts/PFRegalTextPro-Black.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-Black.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-Black.ttf') format('truetype');
    font-weight: 900;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal UBlack';
    src: url('../../res/fonts/PFRegalTextPro-UBlack.eot');
    src: local('../../res/fonts/PFRegalTextPro-UBlack'),
        url('../../res/fonts/PFRegalTextPro-UBlack.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-UBlack.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-UBlack.ttf') format('truetype');
    font-weight: 900;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-MediumItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-MediumItalic'),
        url('../../res/fonts/PFRegalTextPro-MediumItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-MediumItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-MediumItalic.ttf') format('truetype');
    font-weight: 500;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-UBlackItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-UBlackItalic'),
        url('../../res/fonts/PFRegalTextPro-UBlackItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-UBlackItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-UBlackItalic.ttf') format('truetype');
    font-weight: 900;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-RegularAItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-RegularAItalic'),
        url('../../res/fonts/PFRegalTextPro-RegularAItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-RegularAItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-RegularAItalic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-BoldItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-BoldItalic'),
        url('../../res/fonts/PFRegalTextPro-BoldItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-BoldItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-BoldItalic.ttf') format('truetype');
    font-weight: bold;
    font-style: italic;
}

@font-face {
    font-family: 'Charter';
    src: url('../../res/fonts/charter-regular.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
}

/*  Regular B */
@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-RegularBItalic.eot');
    src: local('../../res/fonts/PFRegalTextPro-RegularBItalic'),
        url('../../res/fonts/PFRegalTextPro-RegularBItalic.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-RegularBItalic.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-RegularBItalic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../res/fonts/PFRegalTextPro-RegularB.eot');
    src: local('../../res/fonts/PFRegalTextPro-RegularB'),
        url('../../res/fonts/PFRegalTextPro-RegularB.woff2') format('woff2'),
        url('../../res/fonts/PFRegalTextPro-RegularB.woff') format('woff'),
        url('../../res/fonts/PFRegalTextPro-RegularB.ttf') format('truetype');
    font-weight: 300;
    font-style: normal;
}

@font-face {
    font-family: 'JB Mono';
    src: url('../../res/fonts/JetBrainsMono-Regular.eot');
    src: local('../../res/fonts/JetBrainsMono-Regular'),
        url('../../res/fonts/JetBrainsMono-Regular.woff2') format('woff2'),
        url('../../res/fonts/JetBrainsMono-Regular.woff') format('woff'),
        url('../../res/fonts/JetBrainsMono-Regular.ttf') format('truetype');
    font-weight: 300;
    font-style: normal;
}
@font-face {
    font-family: 'JB Mono';
    src: url('../../res/fonts/JetBrainsMono-Italic.eot');
    src: local('../../res/fonts/JetBrainsMono-Italic'),
        url('../../res/fonts/JetBrainsMono-Italic.woff2') format('woff2'),
        url('../../res/fonts/JetBrainsMono-Italic.woff') format('woff'),
        url('../../res/fonts/JetBrainsMono-Italic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'JB Mono';
    src: url('../../res/fonts/JetBrainsMono-Medium.eot');
    src: local('../../res/fonts/JetBrainsMono-Medium'),
        url('../../res/fonts/JetBrainsMono-Medium.woff2') format('woff2'),
        url('../../res/fonts/JetBrainsMono-Medium.woff') format('woff'),
        url('../../res/fonts/JetBrainsMono-Medium.ttf') format('truetype');
    font-weight: 500;
    font-style: normal;
}
@font-face {
    font-family: 'JB Mono';
    src: url('../../res/fonts/JetBrainsMono-Medium-Italic.eot');
    src: local('../../res/fonts/JetBrainsMono-Medium-Italic'),
        url('../../res/fonts/JetBrainsMono-Medium-Italic.woff2') format('woff2'),
        url('../../res/fonts/JetBrainsMono-Medium-Italic.woff') format('woff'),
        url('../../res/fonts/JetBrainsMono-Medium-Italic.ttf') format('truetype');
    font-weight: 500;
    font-style: italic;
}
@font-face {
    font-family: 'Font Awesome 5 Free';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url("../../res/fonts/webfonts/fa-regular-400.eot");
    src: url("../../res/fonts/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"), 
         url("../../res/fonts/webfonts/fa-regular-400.woff2") format("woff2"), 
         url("../../res/fonts/webfonts/fa-regular-400.woff") format("woff"), 
         url("../../res/fonts/webfonts/fa-regular-400.ttf") format("truetype"), 
         url("../../res/fonts/webfonts/fa-regular-400.svg#fontawesome") format("svg"); 
    font-display: swap;
}
    
.fa {
    font-family: 'Font Awesome 5 Free';
    font-weight: 400;
    font-display: swap;
}
@font-face {
  font-family: 'Font Awesome 5 Brands';
  font-style: normal;
  font-weight: 400;
  font-display: auto;
  src: url("../../res/fonts/fa-brands-400.eot");
  src: url("../../res/fonts/fa-brands-400.eot?#iefix") format("embedded-opentype"), url("../../res/fonts/fa-brands-400.woff2") format("woff2"), url("../../res/fonts/fa-brands-400.woff") format("woff"), url("../../res/fonts/fa-brands-400.ttf") format("truetype"), url("../../res/fonts/fa-brands-400.svg#fontawesome") format("svg"); 
}

.fab {
  font-family: 'Font Awesome 5 Brands';
  font-weight: 400; 
}

@font-face {
  font-family: 'Font Awesome 5 Free';
  font-style: normal;
  font-weight: 400;
  font-display: auto;
  src: url("../../res/fonts/fa-regular-400.eot");
  src: url("../../res/fonts/fa-regular-400.eot?#iefix") format("embedded-opentype"), url("../../res/fonts/fa-regular-400.woff2") format("woff2"), url("../../res/fonts/fa-regular-400.woff") format("woff"), url("../../res/fonts/fa-regular-400.ttf") format("truetype"), url("../../res/fonts/fa-regular-400.svg#fontawesome") format("svg"); 
}

.far {
  font-family: 'Font Awesome 5 Free';
  font-weight: 400; 
}

@font-face {
  font-family: 'Font Awesome 5 Free';
  font-style: normal;
  font-weight: 900;
  font-display: auto;
  src: url("../../res/fonts/fa-solid-900.eot");
  src: url("../../res/fonts/fa-solid-900.eot?#iefix") format("embedded-opentype"), url("../../res/fonts/fa-solid-900.woff2") format("woff2"), url("../../res/fonts/fa-solid-900.woff") format("woff"), url("../../res/fonts/fa-solid-900.ttf") format("truetype"), url("../../res/fonts/fa-solid-900.svg#fontawesome") format("svg"); 
}
</style>  
    <!--
    <div class="book-title-container d-none d-md-block">
        <div class="book-title">Knowledge Base</div>
        <div class="book-part-title-block">pt.1 <a href="../..//ru/Memory/01-00-MemoryManagement-Intro.html" class="book-part-title">Управление памятью</a></div>
        <div class="book-part-title-block">pt.2 <a href="../..//ru/Execution/02-00-ExecutionFlow-Intro.html" class="book-part-title">Поток исполнения команд</a></div>
        <br><a href="#" class="book-superheading-title">Обоснование выбора</a>
        / <a href="#" class="book-superheading-title">Упрощенное описание</a>
        / <a href="#" class="book-superheading-title">Подробное описание</a>
    </div>
    -->
    <header class="header fixed">
        <p class="conflogo">KB</p> 
        <div class="menu">
            <div><a href="index.html">О конференции</a></div>
            <div><a href="mentor.html">Ментор</a></div>
            <div><a href="practice.html">Практика</a></div>
            <div><a href="matrix.html">Доклады</a></div>
            <a href="register.html" class="register_button">РЕГИСТРАЦИЯ</a>
        </div>

        <!-- mobile-menu -->

        <div class="hamburger-menu">
            <input id="menu__toggle" type="checkbox" />
            <label class="menu__btn" for="menu__toggle">
              <span></span>
            </label>
        
            <div class="menu__box">
                <p class="menu__header_current">На странице</p>
                <ol class="menu__list">
                    <li><a href="#section-1">
Ссылочные типы</a></li>
<li><a href="#section-5">
Создание объекта</a></li>

                </ol>
                <p class="menu__header_total">Содержание</p>
                <ul style="padding: 0;">
                    <li style="
                        display: inline-block;
                        width: 100%;
                        margin: 0;
                        text-align: center;
                        font-size: 1.2em;
                        font-family: charter;
                        ">
                        <p>Управление памятью</p>
                        <ul>
                            <li>A</li>
                            <li>B</li>
                            <li>C</li>
                        </ul>
                    </li>
                    <li style="
                        display: inline-block;
                        width: 100%;
                        margin: 0;
                        text-align: center;
                        font-family: charter;
                        font-size: 1.2em;
                        ">
                        <p>Управление памятью</p>
                        <ul>
                            <li>A</li>
                            <li>B</li>
                            <li>C</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <div class="book-container">
        <div class="article-container">
            <!--<p class="d-xs-block d-sm-none">XS</p>
            <p class="d-none d-xs-block d-sm-none">SM</p>
            <p class="d-none d-sm-block d-md-none">MD</p>
            <p class="d-none d-lg-block d-xl-none">LG</p>
            <p class="d-none d-xl-block">XL</p> -->
            <blockquote class="breadcrumbs">
<p >
 <a href="../readme.html">Содержание</a> / <a href="./01-00-MemoryManagement-Intro.html">Основы управления памятью</a></p>
</blockquote>
<h1 id="section">Время жизни сущностей</h1>
<div class="paragraph-container">
<div class="paragraph-left-side">01</div>
<p >
Один из воп&shy;ро&shy;сов, ко&shy;то&shy;рые мо&shy;гут очень силь&shy;но вли&shy;ять на про&shy;из&shy;во&shy;ди&shy;тель&shy;ность на&shy;ших при&shy;ло&shy;же&shy;ний - это по&shy;ли&shy;ти&shy;ка вы&shy;бо&shy;ра ти&shy;па сущ&shy;нос&shy;ти: класс или струк&shy;ту&shy;ра, и конт&shy;роль за их вре&shy;ме&shy;нем жиз&shy;ни. Ведь ар&shy;хи&shy;тек&shy;то&shy;ры плат&shy;фор&shy;мы не прос&shy;то так вы&shy;де&shy;ли&shy;ли для нас эти два ти&shy;па дан&shy;ных. Это де&shy;ле&shy;ние в пер&shy;вую оче&shy;редь обус&shy;лов&shy;ле&shy;но воз&shy;мож&shy;нос&shy;тя&shy;ми оп&shy;ти&shy;ми&shy;за&shy;ции при&shy;ло&shy;же&shy;ний, ар&shy;хи&shy;тек&shy;ту&shy;ра ко&shy;то&shy;рых учи&shy;ты&shy;ва&shy;ет осо&shy;бен&shy;нос&shy;ти обо&shy;их групп ти&shy;пов.</p>
<div class="paragraph-right-side">01</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">02</div>
<p >
Как уже бы&shy;ло ска&shy;за&shy;но в гла&shy;ве <a href="../ReferenceTypesVsValueTypes.html">Ссылочные и значимые типы данных</a>, ог&shy;ром&shy;ным пре&shy;и&shy;му&shy;щест&shy;вом зна&shy;чи&shy;мых ти&shy;пов дан&shy;ных яв&shy;ля&shy;ет&shy;ся то, что их не на&shy;до ал&shy;ло&shy;ци&shy;ро&shy;вать. Т.е. дру&shy;ги&shy;ми сло&shy;ва&shy;ми ес&shy;ли кто-то рас&shy;по&shy;ла&shy;га&shy;ет эк&shy;земп&shy;ляр зна&shy;чи&shy;мо&shy;го ти&shy;па в ло&shy;каль&shy;ных пе&shy;ре&shy;мен&shy;ных или па&shy;ра&shy;мет&shy;рах ме&shy;то&shy;да, то рас&shy;по&shy;ло&shy;же&shy;ние идёт на сте&shy;ке (не вы&shy;де&shy;ляя до&shy;пол&shy;ни&shy;тель&shy;ной па&shy;мя&shy;ти в ку&shy;че). Эта опе&shy;ра&shy;ция - та, о ко&shy;то&shy;рой вам на&shy;до меч&shy;тать, т.к. имен&shy;но она мак&shy;си&shy;маль&shy;но быс&shy;тра и эф&shy;фек&shy;тив&shy;на. Если же струк&shy;ту&shy;ра рас&shy;по&shy;ла&shy;га&shy;ет&shy;ся в по&shy;лях ссы&shy;лоч&shy;но&shy;го ти&shy;па (клас&shy;са), то под нее опе&shy;ра&shy;ция вы&shy;де&shy;ле&shy;ния па&shy;мя&shy;ти так&shy;же не вы&shy;зы&shy;ва&shy;ет&shy;ся: ведь она яв&shy;ля&shy;ет&shy;ся струк&shy;тур&shy;ной частью это&shy;го ссы&shy;лоч&shy;но&shy;го ти&shy;па. Одна&shy;ко всё го&shy;раз&shy;до слож&shy;нее с ссы&shy;лоч&shy;ны&shy;ми ти&shy;па&shy;ми. Ведь, ес&shy;ли речь идет о них, то мы име&shy;ем це&shy;лый на&shy;бор слож&shy;нос&shy;тей при вы&shy;де&shy;ле&shy;нии па&shy;мя&shy;ти под их эк&shy;земп&shy;ля&shy;ры. Причём, что са&shy;мое пе&shy;чаль&shy;ное, а мо&shy;жет быть да&shy;же обид&shy;ное - от нас поч&shy;ти ни&shy;как не за&shy;ви&shy;сит, на ка&shy;кой из ал&shy;го&shy;рит&shy;мов вы&shy;де&shy;ле&shy;ния па&shy;мя&shy;ти мы на&shy;по&shy;рем&shy;ся: на са&shy;мый быст&shy;рый ва&shy;ри&shy;ант из че&shy;тырёх или же на са&shy;мый тя&shy;же&shy;ло&shy;вес&shy;ный.</p>
<div class="paragraph-right-side">02</div>
</div>
<h2 id="section-1">Ссылочные типы</h2>
<h3 id="section-2">Общий обзор</h3>
<div class="paragraph-container">
<div class="paragraph-left-side">03</div>
<p >
Для це&shy;лост&shy;нос&shy;ти кар&shy;ти&shy;ны при даль&shy;ней&shy;шем чте&shy;нии расс&shy;мот&shy;рим осо&shy;бен&shy;нос&shy;ти вре&shy;ме&shy;ни жиз&shy;ни эк&shy;земп&shy;ля&shy;ров ссы&shy;лоч&shy;ных ти&shy;пов дан&shy;ных. Ссы&shy;лоч&shy;ные ти&shy;пы об&shy;ла&shy;да&shy;ют сле&shy;ду&shy;ю&shy;щи&shy;ми свой&shy;ства&shy;ми в воп&shy;ро&shy;се вре&shy;ме&shy;ни собст&shy;венной жиз&shy;ни:</p>
<div class="paragraph-right-side">03</div>
</div>
<ul>
<li>
<p >
У ссы&shy;лоч&shy;ных ти&shy;пов в от&shy;ли&shy;чии от зна&shy;чи&shy;мых де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;ное на&shy;ча&shy;ло жиз&shy;ни. Дру&shy;ги&shy;ми сло&shy;ва&shy;ми они по&shy;рож&shy;да&shy;ют&shy;ся тог&shy;да и толь&shy;ко тог&shy;да, ког&shy;да кто-ли&shy;бо зап&shy;ро&shy;сил их соз&shy;да&shy;ние;</p>
</li>
<li>
<p >
Одна&shy;ко, они име&shy;ют не&shy;де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;ный ос&shy;во&shy;бож&shy;де&shy;ние: мы не зна&shy;ем, ког&shy;да про&shy;изой&shy;дет ос&shy;во&shy;бож&shy;де&shy;ние па&shy;мя&shy;ти из под них. Мы не мо&shy;жем выз&shy;вать GC для конк&shy;рет&shy;но&shy;го эк&shy;земп&shy;ля&shy;ра да&shy;же для слу&shy;чая с Large Objects Heap, где эта опе&shy;ра&shy;ция мог&shy;ла бы быть впол&shy;не умес&shy;тна;</p>
</li>
</ul>
<p >
Эти два свой&shy;ства да&shy;ют нам нем&shy;но&shy;го пи&shy;щи для раз&shy;мыш&shy;ле&shy;ний:</p>
<ul>
<li>
<p >
эк&shy;земп&shy;ля&shy;ры клас&shy;сов унич&shy;то&shy;жа&shy;ют&shy;ся в слу&shy;чай&shy;ное вре&shy;мя в не&shy;оп&shy;ре&shy;де&shy;лен&shy;но от&shy;да&shy;лен&shy;ном бу&shy;ду&shy;щем;</p>
</li>
<li>
<p >
их унич&shy;то&shy;же&shy;ние обус&shy;лав&shy;ли&shy;ва&shy;ет&shy;ся уте&shy;рей ссы&shy;лок на них;</p>
</li>
<li>
<p >
по&shy;э&shy;то&shy;му с од&shy;ной сто&shy;ро&shy;ны это зна&shy;чит, что опе&shy;ра&shy;ция ос&shy;во&shy;бож&shy;де&shy;ния пос&shy;лед&shy;ней ссыл&shy;ки на объ&shy;ект прев&shy;ра&shy;ща&shy;ет&shy;ся в де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;ную опе&shy;ра&shy;цию &laquo;уда&shy;ле&shy;ния&raquo; объ&shy;ек&shy;та из зо&shy;ны ви&shy;ди&shy;мос&shy;ти при&shy;ло&shy;же&shy;ния. Он ещё есть, су&shy;щес&shy;тву&shy;ет, но не&shy;до&shy;ся&shy;га&shy;ем для все&shy;го ос&shy;таль&shy;но&shy;го при&shy;ло&shy;же&shy;ния;</p>
</li>
<li>
<p >
од&shy;на&shy;ко, с дру&shy;гой сто&shy;ро&shy;ны мы да&shy;ле&shy;ко не всег&shy;да в кур&shy;се, ка&shy;кое имен&shy;но об&shy;ну&shy;ле&shy;ние ссыл&shy;ки бу&shy;дет пос&shy;лед&shy;ним, что ли&shy;ша&shy;ет нас свой&shy;ства де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;нос&shy;ти в об&shy;ну&shy;ле&shy;нии пос&shy;лед&shy;ней ссыл&shy;ки.</p>
</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">04</div>
<p >
Еще од&shy;ним очень важ&shy;ным свой&shy;с&shy;твом яв&shy;ля&shy;ет&shy;ся на&shy;ли&shy;чие вир&shy;ту&shy;ал&shy;ьного ме&shy;то&shy;да фи&shy;на&shy;ли&shy;за&shy;ции объ&shy;ек&shy;та. Этот ме&shy;тод вы&shy;зы&shy;ва&shy;ет&shy;ся во вре&shy;мя сра&shy;ба&shy;ты&shy;ва&shy;ния сбор&shy;щи&shy;ка му&shy;со&shy;ра: т.е. в не&shy;оп&shy;ре&shy;де&shy;лен&shy;ном бу&shy;ду&shy;щем. И не&shy;об&shy;хо&shy;дим дан&shy;ный ме&shy;тод для од&shy;но&shy;го: кор&shy;рект&shy;но&shy;го зак&shy;ры&shy;тия не&shy;уп&shy;рав&shy;ля&shy;е&shy;мых ре&shy;сур&shy;сов, ко&shy;то&shy;ры&shy;ми вла&shy;де&shy;ет объ&shy;ект в тех и толь&shy;ко тех слу&shy;ча&shy;ях, ког&shy;да что-то пош&shy;ло не так (нап&shy;ри&shy;мер, бы&shy;ло выб&shy;ро&shy;ше&shy;но ис&shy;клю&shy;че&shy;ние) и прог&shy;рам&shy;ма бо&shy;лее не смо&shy;жет са&shy;мос&shy;то&shy;я&shy;те&shy;но это сде&shy;лать (код, ко&shy;то&shy;рый от&shy;ве&shy;ча&shy;ет за ос&shy;во&shy;бож&shy;де&shy;ние дан&shy;ных ре&shy;сур&shy;сов ни&shy;ког&shy;да бо&shy;лее не вы&shy;зо&shy;вет&shy;ся всле&shy;д&shy;ствие сра&shy;ба&shy;ты&shy;ва&shy;ния ис&shy;клю&shy;чи&shy;тель&shy;ной си&shy;ту&shy;а&shy;ции). И, пос&shy;коль&shy;ку вре&shy;мя вы&shy;зо&shy;ва дан&shy;но&shy;го ме&shy;то&shy;да ров&shy;но как и ос&shy;во&shy;бож&shy;де&shy;ние па&shy;мя&shy;ти из под объ&shy;ек&shy;та от нас не за&shy;ви&shy;сят, его вы&shy;зов так&shy;же не яв&shy;ля&shy;ет&shy;ся де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;ным. Ма&shy;ло то&shy;го, он яв&shy;ля&shy;ет&shy;ся асинх&shy;рон&shy;ным, т.к. осу&shy;щес&shy;твя&shy;ет&shy;ся в от&shy;дель&shy;ном по&shy;то&shy;ке во вре&shy;мя ис&shy;пол&shy;не&shy;ния при&shy;ло&shy;же&shy;ния. Это важ&shy;но пом&shy;нить, т.к. ес&shy;ли, нап&shy;ри&shy;мер, ва&shy;ше при&shy;ло&shy;же&shy;ние име&shy;ет ло&shy;ги&shy;ку пов&shy;тор&shy;ной по&shy;пыт&shy;ки ра&shy;бо&shy;ты с ре&shy;сур&shy;сом и ес&shy;ли про&shy;изош&shy;ла ка&shy;кая-то ошиб&shy;ка (нап&shy;ри&shy;мер, <code>ThreadAbortException</code>), в ре&shy;зуль&shy;та&shy;те ко&shy;то&shy;рой ре&shy;сур&shy;сы &laquo;по&shy;вис&shy;ли&raquo; в оче&shy;ре&shy;ди на фи&shy;на&shy;ли&shy;за&shy;цию, то это зна&shy;чит, что вы не смо&shy;же&shy;те от&shy;к&shy;рыть этот ре&shy;сурс (нап&shy;ри&shy;мер, файл), по&shy;ка не от&shy;ра&shy;бо&shy;та&shy;ет оче&shy;редь на фи&shy;на&shy;ли&shy;за&shy;цию, в ко&shy;то&shy;рой этот ре&shy;сурс бу&shy;дет ос&shy;во&shy;бождён.</p>
<div class="paragraph-right-side">04</div>
</div>
<blockquote>
<p >
Одна&shy;ко, там где есть не&shy;оп&shy;ре&shy;де&shy;лен&shy;ность, прог&shy;рам&shy;мис&shy;ту всег&shy;да хо&shy;чет&shy;ся внес&shy;ти оп&shy;ре&shy;де&shy;лен&shy;ность и как ре&shy;зуль&shy;тат, воз&shy;ник ин&shy;тер&shy;фейс <code>IDisposable</code>, речь о ко&shy;то&shy;ром пой&shy;дет чуть поз&shy;же, в сле&shy;ду&shy;ю&shy;щей гла&shy;ве. Я сей&shy;час мо&shy;гу ска&shy;зать лишь од&shy;но: он ре&shy;а&shy;ли&shy;зу&shy;ет&shy;ся ес&shy;ли не&shy;об&shy;хо&shy;ди&shy;мо, что&shy;бы внеш&shy;ний код мог са&shy;мос&shy;то&shy;я&shy;тель&shy;но от&shy;дать ко&shy;ман&shy;ду на ос&shy;во&shy;бож&shy;де&shy;ние ре&shy;сур&shy;сов объ&shy;ек&shy;та. Т.е. де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;но со&shy;об&shy;щить объ&shy;ек&shy;ту, что он бо&shy;лее не ну&shy;жен.</p>
</blockquote>
<h3 id="section-3">В защиту текущего подхода</h3>
<div class="paragraph-container">
<div class="paragraph-left-side">05</div>
<p >
Мы ни&shy;ког&shy;да не за&shy;ду&shy;мы&shy;ва&shy;лись (а мо&shy;жет толь&shy;ко я?) над тем, что бы&shy;ло бы, будь всё по-дру&shy;го&shy;му: ес&shy;ли бы па&shy;мять ос&shy;во&shy;бож&shy;да&shy;лась де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;но. Те&shy;ку&shy;щий под&shy;ход с ав&shy;то&shy;ма&shy;ти&shy;чес&shy;кой па&shy;мятью, ког&shy;да мы не за&shy;ду&shy;мы&shy;ва&shy;ем&shy;ся, где вы&shy;де&shy;лять объ&shy;ек&shy;ты и ког&shy;да их ос&shy;во&shy;бож&shy;дать нам не всег&shy;да нра&shy;вит&shy;ся: ведь бы&shy;ва&shy;ют слу&shy;чаи, ког&shy;да го&shy;то&shy;вых к ос&shy;во&shy;бож&shy;де&shy;нию объ&shy;ек&shy;тов на&shy;кап&shy;ли&shy;ва&shy;ет&shy;ся слиш&shy;ком мно&shy;го и их ос&shy;во&shy;бож&shy;де&shy;ние тор&shy;мо&shy;зит всё при&shy;ло&shy;же&shy;ние. Одна&shy;ко, в за&shy;щи&shy;ту те&shy;ку&shy;ще&shy;го под&shy;хо&shy;да да&shy;вай&shy;те нем&shy;но&shy;го от&shy;вле&shy;чем&shy;ся на сце&shy;на&shy;рии, о ко&shy;то&shy;рых иног&shy;да на&shy;чи&shy;на&shy;ешь за&shy;ду&shy;мы&shy;вать&shy;ся, меч&shy;тая сме&shy;нить те&shy;ку&shy;щий на&shy;бор ал&shy;го&shy;рит&shy;мов:</p>
<div class="paragraph-right-side">05</div>
</div>
<ul>
<li>
<p >
ес&shy;ли вмес&shy;то то&shy;го что&shy;бы ос&shy;во&shy;бож&shy;дать объ&shy;ек&shy;ты по сра&shy;ба&shy;ты&shy;ва&shy;нию GC мы бу&shy;дем ос&shy;во&shy;бож&shy;дать их с по&shy;те&shy;рей пос&shy;лед&shy;ней ссыл&shy;ки, что про&shy;и&shy;зойдёт? Вот наш код прис&shy;ва&shy;и&shy;ва&shy;ет не&shy;ко&shy;то&shy;рой пе&shy;ре&shy;мен&shy;ной <code>null</code>. Тог&shy;да по&shy;лу&shy;ча&shy;ет&shy;ся, что на каж&shy;дом прис&shy;во&shy;е&shy;нии не&shy;об&shy;хо&shy;ди&shy;мо про&shy;ве&shy;рять, идёт ли прис&shy;во&shy;е&shy;ние <code>null</code> или ка&shy;кой-ли&shy;бо дру&shy;гой ра&shy;бо&shy;чей ссыл&shy;ки. Если да, то на&shy;до по&shy;нять, пос&shy;лед&shy;няя ли это бы&shy;ла ссыл&shy;ка. Каж&shy;дый раз счи&shy;тать вхо&shy;дя&shy;щие с ку&shy;чи ссыл&shy;ки, пе&shy;ре&shy;би&shy;рая все объ&shy;ек&shy;ты SOH/LOH - до&shy;ро&shy;го. Зна&shy;чит, на&shy;до что&shy;бы каж&shy;дый объ&shy;ект счи&shy;тал все вхо&shy;дя&shy;щие ссыл&shy;ки сам: ин&shy;кре&shy;мен&shy;ти&shy;руя и дек&shy;ре&shy;мен&shy;ти&shy;руя счётчик на каж&shy;дой опе&shy;ра&shy;ции. Это - до&shy;пол&shy;ни&shy;тель&shy;ное мес&shy;то + до&shy;пол&shy;ни&shy;тель&shy;ные действия. Плюс ко все&shy;му по&shy;лу&shy;ча&shy;ет&shy;ся, что мы уже не мо&shy;жем сжи&shy;мать ку&shy;чу: пос&shy;ле каж&shy;до&shy;го прис&shy;ва&shy;и&shy;ва&shy;ния это де&shy;лать слиш&shy;ком до&shy;ро&shy;го: под&shy;хо&shy;дит толь&shy;ко ме&shy;тод <code>Sweep</code>. Как мы ви&shy;дим, уже на по&shy;верх&shy;нос&shy;ти вспл&shy;ыв&shy;ает очень мно&shy;го проб&shy;лем, не го&shy;во&shy;ря уже о под&shy;роб&shy;нос&shy;тях;</p>
</li>
<li>
<p >
ес&shy;ли ввес&shy;ти опе&shy;ра&shy;тор <code>delete</code>, что&shy;бы как в C++ ос&shy;во&shy;бож&shy;дать объ&shy;ек&shy;ты по тре&shy;бо&shy;ва&shy;нию, до&shy;пол&shy;ни&shy;тель&shy;но воск&shy;ре&shy;ша&shy;ет дест&shy;рук&shy;тор, как сред&shy;ство де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;но&shy;го ос&shy;во&shy;бож&shy;де&shy;ния па&shy;мя&shy;ти: ведь ес&shy;ли мы ос&shy;во&shy;бож&shy;да&shy;ем объ&shy;ект опе&shy;ра&shy;то&shy;ром <code>delete</code>, не&shy;об&shy;хо&shy;ди&shy;мо та&shy;ким же об&shy;ра&shy;зом ос&shy;во&shy;бож&shy;дать те объ&shy;ек&shy;ты, ко&shy;то&shy;ры&shy;ми этот объ&shy;ект вла&shy;де&shy;ет. Зна&shy;чит, не&shy;об&shy;хо&shy;дим ме&shy;тод, ко&shy;то&shy;рый бу&shy;дет вы&shy;зы&shy;вать&shy;ся при раз&shy;ру&shy;ше&shy;нии объ&shy;ек&shy;та: дест&shy;рук&shy;тор эк&shy;земп&shy;ля&shy;ра ти&shy;па. Это при&shy;ве&shy;дет к уве&shy;ли&shy;че&shy;нию слож&shy;нос&shy;ти раз&shy;ра&shy;бот&shy;ки и удо&shy;ро&shy;жа&shy;нию соп&shy;ро&shy;вож&shy;де&shy;ния прог&shy;рамм: утеч&shy;ки бу&shy;дут пос&shy;то&shy;ян&shy;но. Плюс ко все&shy;му про&shy;че&shy;му воз&shy;ник&shy;нет пу&shy;та&shy;ни&shy;ца при ос&shy;во&shy;бож&shy;де&shy;нии па&shy;мя&shy;ти: мы ли&shy;ша&shy;ем&shy;ся воз&shy;мож&shy;нос&shy;ти ос&shy;во&shy;бож&shy;дать её в пос&shy;лед&shy;ней точ&shy;ке ис&shy;поль&shy;зо&shy;ва&shy;ния. Т.е. те&shy;перь мы дол&shy;жны это де&shy;лать в стро&shy;го от&shy;ве&shy;ден&shy;ном мес&shy;те.</p>
</li>
<li>
<p >
ес&shy;ли вво&shy;дить сме&shy;шан&shy;ный ал&shy;го&shy;ритм: в це&shy;лом что&shy;бы ра&shy;бо&shy;та&shy;ло как сей&shy;час, но что&shy;бы был опе&shy;ра&shy;тор <code>delete</code>. Нап&shy;ри&shy;мер, вы мне ска&shy;же&shy;те, вам за&shy;хо&shy;чет&shy;ся ос&shy;во&shy;бож&shy;дать мас&shy;си&shy;вы дан&shy;ных, ко&shy;то&shy;рые бы&shy;ли ис&shy;поль&shy;зо&shy;ва&shy;ны под ска&shy;чи&shy;ва&shy;ние изоб&shy;ра&shy;же&shy;ний ров&shy;но в оп&shy;ре&shy;де&shy;лен&shy;ный мо&shy;мент. По&shy;то&shy;му что ес&shy;ли на&shy;ше при&shy;ло&shy;же&shy;ние ка&shy;ча&shy;ет изоб&shy;ра&shy;же&shy;ния друг за дру&shy;гом и при этом они дос&shy;та&shy;точ&shy;но быс&shy;тро ста&shy;но&shy;вят&shy;ся не нуж&shy;ны, то мы вхо&shy;лос&shy;тую вы&shy;де&shy;ля&shy;ем ку&shy;чу па&shy;мя&shy;ти, ко&shy;то&shy;рая быс&shy;тро ко&shy;пит&shy;ся и при&shy;во&shy;дит к вы&shy;зо&shy;ву GC. Это осо&shy;бен&shy;но ак&shy;ту&shy;ально для мо&shy;биль&shy;ных при&shy;ло&shy;же&shy;ний на Xamarin и эле&shy;мен&shy;та уп&shy;рав&shy;ле&shy;ния &laquo;вир&shy;ту&shy;альный спи&shy;сок&raquo;, где при быст&shy;ром скрол&shy;ле изоб&shy;ра&shy;же&shy;ний они в боль&shy;ших ко&shy;ли&shy;чест&shy;вах гру&shy;зят&shy;ся, а по&shy;том ста&shy;но&shy;вят&shy;ся не&shy;нуж&shy;ны&shy;ми. Если уда&shy;лять их сра&shy;зу, то не бу&shy;дет си&shy;ту&shy;а&shy;ции с боль&shy;шим GC, ко&shy;то&shy;рый ис&shy;пор&shy;тит ани&shy;ма&shy;цию прок&shy;рут&shy;ки. Одна&shy;ко, тут воз&shy;ник&shy;нут слож&shy;нос&shy;ти для GC. При руч&shy;ном ос&shy;во&shy;бож&shy;де&shy;нии па&shy;мя&shy;ти, пос&shy;лед&shy;няя в свою оче&shy;редь ста&shy;нет фраг&shy;мен&shy;ти&shy;ро&shy;ва&shy;на и мо&shy;жет пе&shy;рес&shy;тать вме&shy;щать в се&shy;бя те мас&shy;си&shy;вы дан&shy;ных, ко&shy;то&shy;рые вы зап&shy;ро&shy;си&shy;те под сле&shy;ду&shy;ю&shy;щие изоб&shy;ра&shy;же&shy;ния. Как след&shy;с&shy;твие - всё рав&shy;но про&shy;изой&shy;дет GC. Если бло&shy;ки па&shy;мя&shy;ти с руч&shy;ным уп&shy;рав&shy;ле&shy;ни&shy;ем рас&shy;по&shy;ла&shy;гать в LOH, то руч&shy;ное ос&shy;во&shy;бож&shy;де&shy;ние хо&shy;ро&shy;шо &laquo;ля&shy;жет&raquo; на его ал&shy;го&shy;рит&shy;мы. Одна&shy;ко, всё так&shy;же бу&shy;дет при&shy;во&shy;дить к фраг&shy;мен&shy;та&shy;ции и даль&shy;ней&shy;ше&shy;му сра&shy;ба&shy;ты&shy;ва&shy;нию пол&shy;но&shy;го GC. Един&shy;ствен&shy;но вер&shy;ное ре&shy;ше&shy;ние - ис&shy;поль&shy;зо&shy;вать пул мас&shy;си&shy;вов и Span/Memory для дос&shy;ту&shy;па к под&shy;ди&shy;а&shy;па&shy;зо&shy;ну ин&shy;дек&shy;сов. Но тог&shy;да за&shy;чем вво&shy;дить <code>delete</code>?</p>
</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">06</div>
<p >
Тог&shy;да по&shy;лу&shy;ча&shy;ет&shy;ся, что те&shy;ку&shy;щее ре&shy;ше&shy;ние - прек&shy;рас&shy;но и на&shy;до прос&shy;то на&shy;у&shy;чить&shy;ся им пра&shy;виль&shy;но поль&shy;зо&shy;вать&shy;ся. Этим мы чуть поз&shy;же и зай&shy;мем&shy;ся.</p>
<div class="paragraph-right-side">06</div>
</div>
<h3 id="section-4">Предварительные выводы</h3>
<div class="paragraph-container">
<div class="paragraph-left-side">07</div>
<p >
Из все&shy;го ска&shy;зан&shy;но&shy;го мож&shy;но уви&shy;деть, что у лю&shy;бо&shy;го объ&shy;ек&shy;та есть не&shy;ко&shy;то&shy;рое вре&shy;мя его су&shy;щест&shy;во&shy;ва&shy;ния. Это мо&shy;жет по&shy;ка&shy;зать&shy;ся три&shy;ви&shy;альной мыслью, ко&shy;то&shy;рая ле&shy;жит на по&shy;верх&shy;нос&shy;ти, но не все так од&shy;ноз&shy;нач&shy;но:</p>
<div class="paragraph-right-side">07</div>
</div>
<ul>
<li>
<p >
важ&shy;но по&shy;ни&shy;мать, как, ког&shy;да и при ка&shy;ких иных ус&shy;ло&shy;ви&shy;ях <em>объект создается</em>. Ведь его соз&shy;да&shy;ние за&shy;ни&shy;ма&shy;ет не&shy;ко&shy;то&shy;рое не всег&shy;да ко&shy;рот&shy;кое вре&shy;мя. И вы не мо&shy;же&shy;те за&shy;ра&shy;нее уга&shy;дать, по ка&shy;ко&shy;му ал&shy;го&shy;рит&shy;му он бу&shy;дет соз&shy;дан: прос&shy;тым пе&shy;ре&shy;но&shy;сом ука&shy;за&shy;те&shy;ля в слу&shy;чае на&shy;ли&shy;чия мес&shy;та в allocation context, всле&shy;д&shy;твие не&shy;об&shy;хо&shy;ди&shy;мос&shy;ти рас&shy;ши&shy;ре&shy;ния или пе&shy;ре&shy;но&shy;са allocation context, не&shy;об&shy;хо&shy;ди&shy;мос&shy;ти сжа&shy;тия эфи&shy;мер&shy;но&shy;го сег&shy;мен&shy;та или же не&shy;об&shy;хо&shy;ди&shy;мос&shy;ти соз&shy;да&shy;ния но&shy;во&shy;го эфи&shy;мер&shy;но&shy;го сег&shy;мен&shy;та с его пол&shy;ным струк&shy;ту&shy;ри&shy;ро&shy;ва&shy;ни&shy;ем;</p>
</li>
<li>
<p >
так&shy;же сто&shy;ит по&shy;ни&shy;мать, нас&shy;коль&shy;ко &laquo;по&shy;пу&shy;ляр&shy;ным&raquo; бу&shy;дет объ&shy;ект <em>во время его жизни</em> и как дол&shy;го он бу&shy;дет су&shy;щест&shy;во&shy;вать: ка&shy;кое ко&shy;ли&shy;чес&shy;тво иных объ&shy;ек&shy;тов бу&shy;дет на не&shy;го ссы&shy;лать&shy;ся и как дол&shy;го. Этот фак&shy;тор влияет как на сбор&shy;ку му&shy;со&shy;ра, фраг&shy;мен&shy;та&shy;цию ку&shy;чи, вре&shy;мя соз&shy;да&shy;ния дру&shy;гих объ&shy;ек&shy;тов и что са&shy;мое ин&shy;те&shy;рес&shy;ное - на вре&shy;мя об&shy;хо&shy;да гра&shy;фа объ&shy;ек&shy;тов в фа&shy;зе мар&shy;ки&shy;ров&shy;ки дос&shy;ти&shy;жи&shy;мых объ&shy;ек&shy;тов сбор&shy;щи&shy;ком му&shy;со&shy;ра;</p>
</li>
<li>
<p >
а так&shy;же, что ло&shy;гич&shy;но и очень важ&shy;но: как объ&shy;ект бу&shy;дет <em>достигать</em> сос&shy;то&shy;я&shy;ния ос&shy;во&shy;бож&shy;де&shy;ния (сос&shy;то&shy;я&shy;ние выб&shy;ро&shy;шен&shy;нос&shy;ти зву&shy;чит грус&shy;тно). Это зна&shy;чит, бу&shy;дет ли осу&shy;щ&shy;еств&shy;ляться де&shy;тер&shy;ме&shy;ни&shy;ро&shy;ван&shy;ное его раз&shy;ру&shy;ше&shy;ние или нет. Нап&shy;ри&shy;мер, при по&shy;мо&shy;щи <code>IDisposable.Dispose</code></p>
</li>
<li>
<p >
и ос&shy;во&shy;бож&shy;дать&shy;ся - быть подх&shy;ва&shy;чен&shy;ным Garbage Collector'ом с даль&shy;ней&shy;шей воз&shy;мож&shy;ностью вы&shy;зо&shy;ва фи&shy;на&shy;ли&shy;за&shy;то&shy;ра.</p>
</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">08</div>
<p >
Каж&shy;дый из этих эта&shy;пов оп&shy;ре&shy;де&shy;ля&shy;ет про&shy;из&shy;во&shy;ди&shy;тель&shy;ность при&shy;ло&shy;же&shy;ния и ло&shy;гич&shy;ность его ар&shy;хи&shy;тек&shy;ту&shy;ры. Расс&shy;мот&shy;рим каж&shy;дый этап в от&shy;дель&shy;нос&shy;ти.</p>
<div class="paragraph-right-side">08</div>
</div>
<h2 id="section-5">Создание объекта</h2>
<p >
Все на&shy;чи&shy;на&shy;ет&shy;ся с опе&shy;ра&shy;ции зап&shy;ро&shy;са па&shy;мя&shy;ти к под&shy;сис&shy;те&shy;ме уп&shy;рав&shy;ле&shy;ния па&shy;мятью:</p>
<div class="lang-csharp editor-colors"><div style="color:Black;background-color:White;"><pre>
<span style="color:Blue;">var</span> x = <span style="color:Blue;">new</span> A();
</pre></div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">09</div>
<p >
Эта ка&shy;за&shy;лось бы са&shy;мая прос&shy;тая опе&shy;ра&shy;ция плат&shy;фор&shy;мы .NET кро&shy;ет в се&shy;бе ог&shy;ром&shy;ный пласт ра&shy;бо&shy;ты, ко&shy;то&shy;рый бу&shy;дет опи&shy;сан в от&shy;дель&shy;ной гла&shy;ве.</p>
<div class="paragraph-right-side">09</div>
</div>

        </div>
    </div>
    <footer>
        <div class="book-container footer-container">
            <div class="footer-wrap">
                <img src="../../res/img/logo-w-noindex.svg">
                <p>
                    <a class="footer-link" target="_blank" href="mailto:sidristij@clrium.ru"><i class="far fa-envelope" aria-hidden="true"></i></a>
                    <a class="footer-link" target="_blank" href="https://vk.com/clrium"><i class="fab fa-vk" aria-hidden="true"></i></a>
                    <a class="footer-link" target="_blank" href="https://youtube.com/clrium"><i class="fab fa-youtube" aria-hidden="true"></i></a>
                    <a class="footer-link" target="_blank" href="https://github.com/clrium"><i class="fab fa-github" aria-hidden="true"></i></a>
                    <a class="footer-link" target="_blank" href="skype:stanislav.sidristyi"><i class="fab fa-skype" aria-hidden="true"></i></a>
                    <a class="footer-link" target="_blank" href="https://t.me/clrium_group"><i class="fab fa-telegram" aria-hidden="true"></i></a>
                </p>
            </div>
        </div>
    </footer>
</body>
</html>