<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>.NET Platform Architecture</title>
</head>
<body>
    <script src="../../../../res/jquery.js"></script>
    <link rel="stylesheet" href="../../../../res/bootstrap.css">
    <link rel="stylesheet" href="../../../../res/awesome.css">
    <style>

body {
    font-family: PF Regal,Georgia,serif;
    font-size: 16pt;
    font-weight: 300;
    padding-top: 4em;
    background-color: #fdfdfd;
}

.book-title-container {
    width: 100%;
    text-align: center;
    margin: 73px 0 110px 0;
}

.book-title {
    font-size: 57pt;
    margin: 50px 0 70px 0;
    user-select: none;
}
.book-part-title-block {
    display: inline-block;
}
.book-part-title {
    font-size: 21pt;
    color: #656ab6;
    margin: 0 7px;
}

.book-part-title:hover {
    box-shadow: inset 0 -1px #007bff;
    text-decoration: none;
}

.book-superheading-title {
    font-size: 15pt;
    margin: 0 7px;
    color: #656ab6;
}

.article-container
{
    width: 62%;
}

strong {
    font-weight: 500;
}

p, li {
    margin: 0 0 1em;
    line-height: 1.5em;
    font-family: inherit;
}

ol, li {
    margin-top: 1em;
    margin-bottom: 1em;
}

ol {
    padding-left: 1.21em;
}

ul  {
    padding-left: 1em;
}

ol li, ul li {
    padding-left: 0.5em;	
    font-family: inherit;
    text-align: justify;
}

table {
    margin: 30px 0;
    width: 100%;
}

thead {
    background-color: aliceblue;
}

table th {
    font-weight: 400;
}

table td, table th {
    padding: 7px;
    border-top: solid darkgrey 1px;
    border-bottom: solid darkgrey 1px;
    border-right: dotted darkgray 1px;
    border-left: dotted darkgray 1px;
    font-size: smaller;
}

code, *[class*='lang-'] span, *[class*='lang-'] pre {
    font-family: JB Mono, monospace !important;
}

*[class*='lang-'] {
    padding: 0px 0px 25px 0px;
    font-size: 0.75em;
}


*[class*='lang-'] > div, pre > code {
    border-left-color: #eee;
    border-left-style: dotted;
    border-left-width: 3px;
    padding-left: 25px;
    display: block;
    padding-top: 20px;
    padding-bottom: 20px;
}

*[class*='lang-'] > div pre, pre > code pre {
    margin-bottom: 0;
}

p code:not(.highlight), li code:not(.highlight) {
    font-size: 0.7em;
    color: darkslateblue;
}

/* style for manual selecting */
.box {
    padding: 3px;
    border: gainsboro;
    border-width: 1px;
    border-style: solid;
}

code.highlight {
    font-family: inherit !important;
    font-size: inherit;
    font-weight: inherit;
    color: inherit;
}

p code.highlight, li code.highlight {
    padding: 4px;
    background-color: #ffffa1;
}

.wide {
    width:140%;
}

p a, li a {
    text-decoration: none;
    color: inherit;
    box-shadow: inset 0 -1px #b88b59;
}

p a:hover, li a:hover {
    text-decoration: none;
    color: inherit;
    box-shadow: inset 0 -1px #0056b3;
}

blockquote h5 {
    background-color: aquamarine;
    margin: 16px 0 16px -20px;
    padding: 15px 30px 15px;
}

p img {
    width: 95%;
}

blockquote 
{
    padding-left: 0.4em;
    border-left: 0.5em solid rgba(0,0,0,.08);
    font-style: italic;
}

blockquote.big-quote, 
blockquote.breadcrumbs 
{
    background-color: transparent;
    padding: 0;
    border-left: none;
    font-style: normal;
}

blockquote.breadcrumbs, blockquote.breadcrumbs  p
{
    margin: 0;
    padding: 0;
}

blockquote p {
    padding: 1em 1em 1em 0.6em;
    font-family: inherit;
}

blockquote p code {
    font-family: consolas, monospace;
    font-size: 17px;
    padding: 4px 6px;
}

blockquote p em {
    font-weight: 400;
}

blockquote.big-quote > p {
    margin: 0.7em 0 0.7em 0;
    font-family: Charter;
    font-size: 2.5em;
    padding: 0;
    width: 130%;
    line-height: 1em;
}

h1, h2, h3, h4, h5, h6 {
    margin: 0;
    padding: 0;
    font-weight: 400;
    font-family: inherit;
    hyphens: none;
}

h1 {
    font-size: 2.2em;
    font-family: Charter,Georgia,serif;
    font-weight: 300;
    margin: 1.8em 0 1.8em 0;
    text-align: center;
    width: 140%;
}

h2 {
    padding-top: 1.5em;
    padding-left: 1.5em;
    padding-right: 1.5em;
    margin-bottom: 0.5em;
    font-family: Charter, Arial, Helvetica Neue, sans-serif;
    font-size: 1.4em;
    text-align: center;
}

h3 {
    padding-top: 1.2em;
    font-family: Charter, Arial, Helvetica Neue, sans-serif;
    font-size: 1.15em;
    width: 70%;
}

h4 {
    padding: 1em 0 0 0;
    font-size: 1.2em;
    font-weight: 300;
    font-style: italic;
}

h5 {
    padding: 0.6em 0 0 0;
    font-weight: 300;
    font-size: 1.1em;
}

/* Sidenotes */

.aside-container {
    position: relative;
}
.aside-container p {
    position: relative;
    top: 9px;
}

.aside-container > .aside-side-container {
    display: block;
    position: absolute;
    top: 12px;
    left: 96%;
    width: 34%;
    font-size: 12pt;
    line-height: 20px;
    margin-left: 100px;
    z-index: 1000;
}

.aside-container > .aside-side-container p {
    line-height: 24px;
    font-size: 13pt;
    margin: 0 0 13px 0;
}

.side-regular-block p {
    top: 0;
}

/* Music side player */
.aside-side-container .music-player {
    width: 100%;
    height: 400px;
}

/* media block after h1 */
.aside-container h1 + .aside-side-container.side-media-block h2 {
    margin: 7em 0 1em 0;
    font-family: Proxima Nova,Arial,Helvetica Neue,sans-serif;
    font-weight: 600;
}

.aside-side-container > li {
    display: block;
    font-family: Charter;
}

.aside-side-container > li ul, .aside-side-container > li ol {
    padding-left: 30px;
    margin-top: 0.5em;
    margin-bottom: 0.5em;
}
.aside-side-container > li li {
    padding-left: 6px;
    margin: 0 0 6px;
    line-height: 22px;

    font-family: Charter;
}

.aside-side-container p {
    line-height: 25px;
    font-size: 13pt;
    margin: 0 0 15px 0;
}

.aside-side-container blockquote {
    border: aliceblue;
    border-left-style: solid;
}

/* Paragraphs numbering */
.paragraph-container {
    position: relative;
}
.paragraph-container p {
    position: relative;
    top: 9px;
}

.paragraph-container p, .aside-container > p {
    text-align: justify;
}

.paragraph-container > .paragraph-left-side, .paragraph-container > .paragraph-right-side  {
    font-family: JB Mono, consolas;
    display: block;
    position: absolute;
    top: 17px;
    font-size: 10pt;
    line-height: 20px;
    color: #86abc473;
    z-index: 1000;
}
.paragraph-container > .paragraph-left-side {
    display: none;
    left: -2.1cm;
    width: 35px;
    user-select: none;
}

.paragraph-container > .paragraph-right-side  {
    display: none;
    left: 100%;
    width: 35px;
    padding-left: 45px;
    user-select: none;
}

.article-container
{
    width: 70%;
}

/* X_MENU */
.menu-title {
    text-align: center;
    margin: 35px 50px 35px 50px;
    font-size: 24pt;
    font-family: Charter;
}

.menu-container ol {
    margin: 0;
    padding: 0;
}

.menu-container ol li {
    margin: 0;
    padding: 0;
}

.header {
    height: 2.5em;
    background-color: white;
    position: relative;
    z-index: 1500;
    width: 100%;
    display: flex;
    justify-content: space-between;
    transition: all 1s;
    top: 0;
    box-shadow: 1px -4px 20px rgba(0, 0, 0, .1);
}

.fixed {
    position: fixed !important;
}

.header > .menu {
    pointer-events: auto;
    float: right;
    height: 40px;
    font-family: Charter, 'Helvetica Neue', Arial, sans-serif;
    font-size: 1em;
    color: #fff;
    margin-top:40px;
    margin-right:40px;
}

.menu a {
    color: #fff;
}
.menu a:hover {
    text-decoration: none;
    color: #fff;
}

#menu__toggle {
    opacity: 0;
}

#menu__toggle:checked ~ .menu__btn > span {
    transform: rotate(45deg);
}
#menu__toggle:checked ~ .menu__btn > span::before {
    top: 0;
    transform: rotate(0);
    background-color: black
}
#menu__toggle:checked ~ .menu__btn > span::after {
    top: 0;
    transform: rotate(90deg);
    background-color: black
}
#menu__toggle:checked ~ .menu__box {
    visibility: visible;
    right: 0;
}

.menu__btn {
    display: flex;
    align-items: center;
    position: fixed;
    top: 0;
    right: 0;
    width: 2.5em;
    height: 2.5em;
    cursor: pointer;
    z-index: 1;
    margin: 0;
    padding: 0.7em;
}

.menu__btn > span,
.menu__btn > span::before,
.menu__btn > span::after {
    display: block;
    position: absolute;

    width: 1.1em;
    height: 1px;

    border-bottom: 1px black solid;

    transition-duration: .25s;
}
.menu__btn > span::before {
    content: '';
    top: -7px;
}
.menu__btn > span::after {
    content: '';
    top: 7px;
}

.menu__box {
    display: block;
    position: fixed;
    visibility: hidden;
    top: 0;
    right: -100%;

    width: 100%;
    height: 100%;

    margin: 0;
    padding: 80px 0;

    list-style: none;

    background-color: white;
    box-shadow: 1px 0px 6px rgba(0, 0, 0, .2);

    transition-duration: .25s;

    overflow-y: auto;
}
.menu__box li a:hover {
    text-decoration: none;
    color: inherit;
}
.menu__list {
    font-size: 0.9em;
    margin: 0 2em 0 2em;
}
.menu__list li {
    text-align: left;
}

/* X_HEADER */

.conflogo {
    margin: 0.5em 0 0 0.8em;
    font-size: 1.1em;
    font-family: Charter;
    user-select: none;
}

.invisible {
    display: none;
}

.header > .menu > div {
    display: inline;
    margin-left: 10px;
    margin-right: 10px;
}

.menu__header_current
{
    text-align: center;
    font-size: 2em;
    margin: 0 0 1em 0;
}

.menu__header_total
{
    text-align: center;
    font-size: 2.4em;
    margin: 1.7em 0 0.3em 0;
}
.menu__header_list 
{
    padding: 0;
    margin-top: 0;
    margin-left: 0;
    margin-right: 0;
}
.menu__header_list > li 
{
    display: inline-block;
    width: 100%;
    margin: 0;
    text-align: center;
    font-family: charter;
}
.menu__header_total_sub
{
    font-size: 1.4em;
    margin: 2em 0 1em 0;
}
.menu__header_total_sub2
{
    font-size: 1.1em;
    margin: 1.5em 0 0.6em 1em;
    text-align: left;
}
/* X_FOOTER */

footer {
    margin-top: 2em;
    background-color: black;
    height: 4em;
}

footer > div {
    box-shadow: 0px 2px 2px rgb(0, 0, 0);
}

.footer-container {
    height: 100%;
}

.footer-wrap {
    color: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 25px 0;
}

.footer-wrap p {
    margin: 0;
    padding: 0px;
    line-height: 1em;
}

.footer-container img {
    height: 1.6em;
    margin-top: auto;
    margin-bottom: auto;
}

.footer-link {
    color: white;
    margin: 0 7px;
    font-size: 1em;
    box-shadow: none;
}

.footer-link:hover {
    color: salmon;
    box-shadow: none;
}

/* MEDIA */
/* XXL */
@media (min-width: 1601px) {
    .book-container
    {
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
    }
}

/* XL */
@media (max-width: 1600px) {
    .book-container
    {
        margin-left: 4cm;
        margin-right: 4cm;
    }
}

/* LG */
@media (max-width: 1400px) {
    .book-container
    {
        margin-left: 4cm;
        margin-right: 4cm;
    }

    blockquote.big-quote > p {
        font-size: 2em;
    }
}

/* > MD */
@media (min-width: 992px) {
    .hamburger-menu {
        display: none;
    }
}

/* MD */
@media (max-width: 991px) {
    
    h3 {
        width:80%;
    }

    .book-container
    {
        margin-left: 3cm;
        margin-right: 3cm;
    }
    
    .book-title-container {
        margin: 73px 0 110px 0;
    }

    .book-title {
        font-size: 50pt;
        margin: 50px 0 70px 0;
    }

    .book-part-title {
        font-size: 19pt;
    }

    .book-part-title:hover {
        box-shadow: inset 0 -1px #007bff;
    }

    .book-superheading-title {
        font-size: 15pt;
    }                                     

    .article-container, h1 {
        width: 100%;
    }

    .aside-container p {
        top: 0;
    }

    .aside-container h1 + .aside-side-container.side-media-block h2 {
        display: none;
    }

    .wide {
        width: 100%;     
    }

    .side-regular-block {
        margin: 40px 10px;
        padding-left: 100px;
    }
    .aside-side-container .music-player {
        width: 100%;
        height: 100px;
    }
    .aside-side-container.side-media-block {
        padding: 17px 0;
    }
    .aside-side-container.side-media-block h2 {
        margin-top: 20px;
        font-size: 13pt;
        border: none;
    }

    .aside-container > .aside-side-container
    {
        position: relative;
        top: auto;
        left: auto;
        width: auto;
        height: auto;
        margin: 0;
        padding: 17px;
    }

    blockquote.big-quote > p {
        width: 100%;
        font-size: 2em;
    }

    .paragraph-container .paragraph-left-side {
        left: -55px;
    }

    body {
        font-size: 15pt;
    }

    p code:not(.highlight), li code:not(.highlight) {
        font-size: 11pt;
    }

    p, li {
        line-height: 30px;
    }
    
    li {
        margin: 0 0 10px 0;
    }

    .side-regular-block {
        border-radius: 5px;
        background-image: linear-gradient(180deg,hsla(0,0%,100%,0) 60%,#fff),linear-gradient(70deg,#dbedff 32%,#ebfff0);
        padding: 22px;
    }    

    .menu__list
    {
        margin-top: 0;
        margin-bottom: 0;
    }

    .menu__list, .menu__header_total_sub2
    {
        margin-left: auto;
        margin-right: auto;
        max-width: 800px;
        width: 80%;
    }

    .book-container 
    {
        position: absolute;
        padding: 0 3cm 0 3cm;
        overflow: scroll;
        overflow-x: auto;
        top: 2.5em;
        bottom: 0;
        width: 100%;
        margin: 0;
    }

    footer {
        margin-top: 2em;
        background-color: black;
        height: 4em;
    }

    footer > div {
        position: relative;
        margin: 0 -3cm;
        background: black;
        padding: 0 3cm;
    }
}

/* Smartphone horizontal - SM */
@media (max-width: 767px) {
    .book-title-container {
        margin: 73px 0 110px 0;
    }

    h1 {
        margin: 1.8em 0em 1.8em 0.3em;
    }

    .book-title {
        font-size: 40pt;
        margin: 50px 0 70px 0;
    }

    .book-part-title {
        font-size: 19pt;
    }

    .book-part-title:hover {
        box-shadow: inset 0 -1px #007bff;
    }

    .book-superheading-title {
        font-size: 17pt;
    }

    .book-container {
        padding: 0 2.5cm;
    }
    ul {
        margin-left: 30px;
        margin-right: 30px;
        padding-left: 25px;
    }
    .paragraph-container > .paragraph-left-side {
	    display: block;
        top: 14px;
        font-size: 9pt;
    }
    .paragraph-container > .paragraph-right-side {
    	display: block;
        padding-left: 40px;
        top: 14px;
        font-size: 9pt;
    }
    .footer-container img {
        height: 1.3em;
    } 
}

@media (max-width: 630px) {
    .book-container {
        padding: 0 1.5cm;
    }
    .paragraph-container > .paragraph-left-side {
        left: -33px;
    }
    .paragraph-container > .paragraph-right-side {
        padding-left: 24px;
    }
}
/* Smartphone - XS */
@media (max-width: 575px) {
    .book-container {
        padding: 0 50px 0 30px;
    }
    ul {
        margin: 0;
        padding-left: 20px;
    }

    body {
        font-size: 13pt;
    }

    p code:not(.highlight), li code:not(.highlight) 
    {
        font-size: 10pt;
        padding: 3px;
    }

    *[class*='lang-'] > div, pre > code {
        padding-left: 15px;
        padding-top: 15px;
        padding-bottom: 15px;
    }
    
    ol li, ul li {
        padding-left: 0.2em;	
    }
    
    p, li {
        line-height: 24px;
    }    
    
    .paragraph-container .paragraph-left-side 
    {
        display: none;        
    }
    .paragraph-container .paragraph-right-side 
    {
        padding-left: 21px;
        top: 14px;
	    font-size: 8pt;
    }
    .footer-container img {
        height: 1em;
    } 
    .menu__list {
        margin: 0 1em 0 1em;
    }
    .menu__header_total_sub2
    {
        margin: 1.5em 0 0.6em 1em;
    }
}

/* Fonts */

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-Bold.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-Bold'),
        url('../../../../res/fonts/PFRegalTextPro-Bold.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-Bold.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-Bold.ttf') format('truetype');
    font-weight: bold;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-Medium.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-Medium'),
        url('../../../../res/fonts/PFRegalTextPro-Medium.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-Medium.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-Medium.ttf') format('truetype');
    font-weight: 500;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-BlackItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-BlackItalic'),
        url('../../../../res/fonts/PFRegalTextPro-BlackItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-BlackItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-BlackItalic.ttf') format('truetype');
    font-weight: 900;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-Black.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-Black'),
        url('../../../../res/fonts/PFRegalTextPro-Black.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-Black.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-Black.ttf') format('truetype');
    font-weight: 900;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal UBlack';
    src: url('../../../../res/fonts/PFRegalTextPro-UBlack.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-UBlack'),
        url('../../../../res/fonts/PFRegalTextPro-UBlack.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-UBlack.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-UBlack.ttf') format('truetype');
    font-weight: 900;
    font-style: normal;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-MediumItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-MediumItalic'),
        url('../../../../res/fonts/PFRegalTextPro-MediumItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-MediumItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-MediumItalic.ttf') format('truetype');
    font-weight: 500;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-UBlackItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-UBlackItalic'),
        url('../../../../res/fonts/PFRegalTextPro-UBlackItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-UBlackItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-UBlackItalic.ttf') format('truetype');
    font-weight: 900;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-RegularAItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-RegularAItalic'),
        url('../../../../res/fonts/PFRegalTextPro-RegularAItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-RegularAItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-RegularAItalic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-BoldItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-BoldItalic'),
        url('../../../../res/fonts/PFRegalTextPro-BoldItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-BoldItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-BoldItalic.ttf') format('truetype');
    font-weight: bold;
    font-style: italic;
}

@font-face {
    font-family: 'Charter';
    src: url('../../../../res/fonts/charter-regular.woff2') format('woff2');
    font-weight: normal;
    font-style: normal;
}

/*  Regular B */
@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-RegularBItalic.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-RegularBItalic'),
        url('../../../../res/fonts/PFRegalTextPro-RegularBItalic.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-RegularBItalic.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-RegularBItalic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'PF Regal';
    src: url('../../../../res/fonts/PFRegalTextPro-RegularB.eot');
    src: local('../../../../res/fonts/PFRegalTextPro-RegularB'),
        url('../../../../res/fonts/PFRegalTextPro-RegularB.woff2') format('woff2'),
        url('../../../../res/fonts/PFRegalTextPro-RegularB.woff') format('woff'),
        url('../../../../res/fonts/PFRegalTextPro-RegularB.ttf') format('truetype');
    font-weight: 300;
    font-style: normal;
}

@font-face {
    font-family: 'JB Mono';
    src: url('../../../../res/fonts/JetBrainsMono-Regular.eot');
    src: local('../../../../res/fonts/JetBrainsMono-Regular'),
        url('../../../../res/fonts/JetBrainsMono-Regular.woff2') format('woff2'),
        url('../../../../res/fonts/JetBrainsMono-Regular.woff') format('woff'),
        url('../../../../res/fonts/JetBrainsMono-Regular.ttf') format('truetype');
    font-weight: 300;
    font-style: normal;
}
@font-face {
    font-family: 'JB Mono';
    src: url('../../../../res/fonts/JetBrainsMono-Italic.eot');
    src: local('../../../../res/fonts/JetBrainsMono-Italic'),
        url('../../../../res/fonts/JetBrainsMono-Italic.woff2') format('woff2'),
        url('../../../../res/fonts/JetBrainsMono-Italic.woff') format('woff'),
        url('../../../../res/fonts/JetBrainsMono-Italic.ttf') format('truetype');
    font-weight: 300;
    font-style: italic;
}

@font-face {
    font-family: 'JB Mono';
    src: url('../../../../res/fonts/JetBrainsMono-Medium.eot');
    src: local('../../../../res/fonts/JetBrainsMono-Medium'),
        url('../../../../res/fonts/JetBrainsMono-Medium.woff2') format('woff2'),
        url('../../../../res/fonts/JetBrainsMono-Medium.woff') format('woff'),
        url('../../../../res/fonts/JetBrainsMono-Medium.ttf') format('truetype');
    font-weight: 500;
    font-style: normal;
}
@font-face {
    font-family: 'JB Mono';
    src: url('../../../../res/fonts/JetBrainsMono-Medium-Italic.eot');
    src: local('../../../../res/fonts/JetBrainsMono-Medium-Italic'),
        url('../../../../res/fonts/JetBrainsMono-Medium-Italic.woff2') format('woff2'),
        url('../../../../res/fonts/JetBrainsMono-Medium-Italic.woff') format('woff'),
        url('../../../../res/fonts/JetBrainsMono-Medium-Italic.ttf') format('truetype');
    font-weight: 500;
    font-style: italic;
}
@font-face {
    font-family: 'Font Awesome 5 Free';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url("../../../../res/fonts/webfonts/fa-regular-400.eot");
    src: url("../../../../res/fonts/webfonts/fa-regular-400.eot?#iefix") format("embedded-opentype"), 
         url("../../../../res/fonts/webfonts/fa-regular-400.woff2") format("woff2"), 
         url("../../../../res/fonts/webfonts/fa-regular-400.woff") format("woff"), 
         url("../../../../res/fonts/webfonts/fa-regular-400.ttf") format("truetype"), 
         url("../../../../res/fonts/webfonts/fa-regular-400.svg#fontawesome") format("svg"); 
    font-display: swap;
}
    
.fa {
    font-family: 'Font Awesome 5 Free';
    font-weight: 400;
    font-display: swap;
}
@font-face {
  font-family: 'Font Awesome 5 Brands';
  font-style: normal;
  font-weight: 400;
  font-display: auto;
  src: url("../../../../res/fonts/fa-brands-400.eot");
  src: url("../../../../res/fonts/fa-brands-400.eot?#iefix") format("embedded-opentype"), url("../../../../res/fonts/fa-brands-400.woff2") format("woff2"), url("../../../../res/fonts/fa-brands-400.woff") format("woff"), url("../../../../res/fonts/fa-brands-400.ttf") format("truetype"), url("../../../../res/fonts/fa-brands-400.svg#fontawesome") format("svg"); 
}

.fab {
  font-family: 'Font Awesome 5 Brands';
  font-weight: 400; 
}

@font-face {
  font-family: 'Font Awesome 5 Free';
  font-style: normal;
  font-weight: 400;
  font-display: auto;
  src: url("../../../../res/fonts/fa-regular-400.eot");
  src: url("../../../../res/fonts/fa-regular-400.eot?#iefix") format("embedded-opentype"), url("../../../../res/fonts/fa-regular-400.woff2") format("woff2"), url("../../../../res/fonts/fa-regular-400.woff") format("woff"), url("../../../../res/fonts/fa-regular-400.ttf") format("truetype"), url("../../../../res/fonts/fa-regular-400.svg#fontawesome") format("svg"); 
}

.far {
  font-family: 'Font Awesome 5 Free';
  font-weight: 400; 
}

@font-face {
  font-family: 'Font Awesome 5 Free';
  font-style: normal;
  font-weight: 900;
  font-display: auto;
  src: url("../../../../res/fonts/fa-solid-900.eot");
  src: url("../../../../res/fonts/fa-solid-900.eot?#iefix") format("embedded-opentype"), url("../../../../res/fonts/fa-solid-900.woff2") format("woff2"), url("../../../../res/fonts/fa-solid-900.woff") format("woff"), url("../../../../res/fonts/fa-solid-900.ttf") format("truetype"), url("../../../../res/fonts/fa-solid-900.svg#fontawesome") format("svg"); 
}
</style>  
    <div class="book-title-container d-none d-lg-block">
        <div class="book-title">Knowledge Base</div>
        <div class="book-part-title-block">pt.1 <a href="../../../..//ru/Memory/01-00-MemoryManagement-Intro.html" class="book-part-title">Управление памятью</a></div>
        <div class="book-part-title-block">pt.2 <a href="../../../..//ru/Execution/02-00-ExecutionFlow-Intro.html" class="book-part-title">Поток исполнения команд</a></div>
        <br><a href="#" class="book-superheading-title">Обоснование выбора</a>
        / <a href="#" class="book-superheading-title">Упрощенное описание</a>
        / <a href="#" class="book-superheading-title">Подробное описание</a>
    </div>
    <header class="header fixed d-block d-lg-none">
        <p class="conflogo">KB</p> 

        <!-- mobile-menu -->

        <div class="hamburger-menu">
            <input id="menu__toggle" type="checkbox" />
            <label class="menu__btn" for="menu__toggle">
              <span></span>
            </label>
        
            <div class="menu__box">
                <p class="menu__header_current">На странице</p>
                <ol class="menu__list">
                    <li><a href="#section-1" onclick="$('#menu__toggle').click(); return true;">
Поток в физическом понимании</a></li>
<li><a href="#section-2" onclick="$('#menu__toggle').click(); return true;">
Создание потоков</a></li>
<li><a href="#section-3" onclick="$('#menu__toggle').click(); return true;">
Планирование потоков</a></li>
<li><a href="#windows-api" onclick="$('#menu__toggle').click(); return true;">
Уровень приоритетов </a></li>
<li><a href="#section-5" onclick="$('#menu__toggle').click(); return true;">
Как рассчитываются уровни приоритета?</a></li>
<li><a href="#section-6" onclick="$('#menu__toggle').click(); return true;">
Состояние потока</a></li>
<li><a href="#section-7" onclick="$('#menu__toggle').click(); return true;">
Кванты времени</a></li>
<li><a href="#section-10" onclick="$('#menu__toggle').click(); return true;">
Выводы</a></li>

                </ol>
                <p class="menu__header_total">Содержание</p>
                <ul class="menu__header_list">
                    <li>
                        <p class="menu__header_total_sub">
                            Управление памятью
                        </p>
                        <p class="menu__header_total_sub2">
                            Теоретические вопросы:
                        </p>
                        <ol class="menu__list">
                            <li><p><a href="../../../..//ru/Memory/01-00-MemoryManagement-Intro.html">
                                Общие слова
                            </a></p></li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-02-MemoryManagement-Basics.html">Введение в управление памятью</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-04-MemoryManagement-ThreadStack.html">Стек потока</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-06-MemoryManagement-EntitiesLifetime.html">Время жизни сущности</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-08-MemoryManagement-RefVsValueTypes.html">RefTypes, ValueTypes, Boxing &amp; Unboxing</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-10-MemoryManagement-IDisposable.html">Шаблон IDisposable</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-12-MemoryManagement-Finalizer.html">Финализация</a></p>
                            </li>
                            <li>
                                <p>
                                <a href="../../../..//ru/Memory/01-14-MemoryManagement-Results.html">Выводы</a></p>
                            </li>
                        </ol>
                        <p class="menu__header_total_sub2">
                            Практические вопросы:
                        </p>
                        <ol class="menu__list" start="9">
                            <li><p><a href="../../../..//ru/Memory/02-02-MemoryManagement-MemorySpan.html">
                                Memory&lt;T&gt;, Span&lt;T&gt;
                            </a></p></li>
                        </ol> 
                    </li>
                    <li>
                        <p class="menu__header_total_sub">
                            Поток исполнения команд
                        </p>
                        <p class="menu__header_total_sub2">
                            Многопоточность:
                        </p>
                        <ol class="menu__list">
                            <li><p><a href="../../../..//ru/Execution/1-Threads/1-OS/1-threadsScheduling.html">
                                Потоки и планирование потоков
                            </a></p></li>
                        </ol>
                        <p class="menu__header_total_sub2">
                            Искл­юч­ител­ьные си­ту­а­ции:
                        </p>
                        <ol class="menu__list" start="2">
                            <li><p><a href="../../../..//ru/Execution/2-ExceptionalFlow/1-Exceptions-Intro.html">
                                Введение в исключительные ситуации
                            </a></p></li>
                            <li><p><a href="../../../..//ru/Execution/2-ExceptionalFlow/2-Exceptions-Architecture.html">
                                Архитектура исключительной ситуации
                            </a></p></li>
                            <li><p><a href="../../../..//ru/Execution/2-ExceptionalFlow/3-Exceptions-Events.html">
                                События об исключительных ситуациях
                            </a></p></li>
                            <li><p><a href="../../../..//ru/Execution/2-ExceptionalFlow/4-Exceptions-Types.html">
                                Виды исключительных ситуаций
                            </a></p></li>
                        </ol>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <div class="book-container">
        <div class="article-container">
            <!--<p class="d-xs-block d-sm-none">XS</p>
            <p class="d-none d-xs-block d-sm-none">SM</p>
            <p class="d-none d-sm-block d-md-none">MD</p>
            <p class="d-none d-lg-block d-xl-none">LG</p>
            <p class="d-none d-xl-block">XL</p> -->
            <h1 id="section">Потоки и пла&shy;ни&shy;ро&shy;ва&shy;ние пото&shy;ков</h1>
<p>Что такое поток? Давайте дадим крат&shy;кое опре&shy;де&shy;ле&shy;ние. По своей сути поток это:</p>
<ul>
<li>Сред&shy;ство парал&shy;лель&shy;ного отно&shy;си&shy;тельно дру&shy;гих пото&shy;ков испол&shy;не&shy;ния кода;</li>
<li>Име&shy;ю&shy;щего общий дос&shy;туп ко всем ресур&shy;сам про&shy;цесса.</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">01</div>
<p>Очень часто часто слы&shy;шишь такое мне&shy;ние, что потоки в .NET — они какие-то абсо&shy;лютно свои. И наши .NET потоки явля&shy;ются чем-то более облегчённым чем есть в Windows&shy;. Но на самом деле потоки в .NET явля&shy;ются самыми обыч&shy;ными пото&shy;ками Windows (хоть Windows thread id и скрыто так, что сложно дос&shy;тать). И если Вас удив&shy;ляет, почему я буду расс&shy;ка&shy;зы&shy;вать не-.NET вещи в хабе .NET, скажу вам так: если нет пони&shy;ма&shy;ния этого уровня, можно забыть о хоро&shy;шем пони&shy;ма&shy;нии того, как и почему именно так рабо&shy;тает код: почему мы дол&shy;жны ста&shy;вить vola&shy;tile, исполь&shy;зо&shy;вать Inter&shy;locked и Spin&shy;Wait&shy;. Дальше обыч&shy;ного <code>lock</code> дело не уйдёт. И очень даже зря. Поэ&shy;тому давайте же пос&shy;мот&shy;рим из чего они сос&shy;тоят и как они рож&shy;да&shy;ются.</p>
<div class="paragraph-right-side">01</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">02</div>
<p>По сути поток — это сред&shy;ство эму&shy;ля&shy;ции парал&shy;лель&shy;ного испол&shy;не&shy;ния отно&shy;си&shy;тельно дру&shy;гих пото&shy;ков. Почему эму&shy;ля&shy;ция? Потому, что поток как бы странно и смело это ни зву&shy;чало — это чисто прог&shy;рам&shy;м&shy;ная вещь, кото&shy;рая идёт из опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы. А опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема создаёт этот слой эму&shy;ля&shy;ции для нас. Про&shy;цес&shy;сор при этом о пото&shy;ках ничего не знает вообще. Задача про&shy;цес&shy;сора — просто испол&shy;нять код. Поэ&shy;тому с точки зре&shy;ния про&shy;цес&shy;сора есть только один поток: пос&shy;ле&shy;до&shy;ва&shy;тель&shy;ное испол&shy;не&shy;ние команд. А задача опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы при нали&shy;чии на одном про&shy;цес&shy;сор&shy;ном ядре нес&shy;коль&shy;ких пото&shy;ков каким-либо обра&shy;зом под&shy;ме&shy;нять актив&shy;ный т.о. чтобы эму&shy;ли&shy;ро&shy;вать нес&shy;колько пото&shy;ков, рабо&shy;та&shy;ю&shy;щих парал&shy;лельно. Если бы на каж&shy;дом ядре было по одному потоку, эму&shy;ля&shy;ции бы не было.</p>
<div class="paragraph-right-side">02</div>
</div>
<h2 id="section-1">Поток в физи&shy;чес&shy;ком пони&shy;ма&shy;нии</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">03</div>
<p>"Но как же так?",  &mdash;  ска&shy;жите вы,  &mdash;  "во мно&shy;гих мага&shy;зи&shy;нах и на раз&shy;лич&shy;ных сай&shy;тах я вижу запись &laquo;Intel Xeon 8 ядер 16 пото&shy;ков&raquo;. Говоря по-правде это  &mdash;  либо скуд&shy;ность в тер&shy;ми&shy;но&shy;ло&shy;гии либо  &mdash;  чисто мар&shy;ке&shy;тин&shy;го&shy;вый ход. На самом же деле внутри одного боль&shy;шого про&shy;цес&shy;сора есть в дан&shy;ном слу&shy;чае 8 ядер и каж&shy;дое ядро сос&shy;тоит из двух логи&shy;чес&shy;ких про&shy;цес&shy;со&shy;ров, кото&shy;рые это ядро эму&shy;ли&shy;рует. Такое пове&shy;де&shy;ние дос&shy;тупно при нали&shy;чии в про&shy;цес&shy;соре тех&shy;но&shy;ло&shy;гии Hyper&shy;-Threading&shy;, когда каж&shy;дое ядро эму&shy;ли&shy;рует пове&shy;де&shy;ние двух про&shy;цес&shy;со&shy;ров (но не пото&shy;ков). Дела&shy;ется это для повы&shy;ше&shy;ния про&shy;из&shy;во&shy;ди&shy;тель&shy;ности, да. Но по боль&shy;шому счёту если нет пони&shy;ма&shy;ния, на каких пото&shy;ках идут расчёты, можно полу&shy;чить очень не при&shy;ят&shy;ный сце&shy;на&shy;рий, когда с двух пото&shy;ков, нахо&shy;дя&shy;щихся на одном физи&shy;чес&shy;ком, но на двух  &mdash;  вир&shy;ту&shy;альных ядрах, прог&shy;рамма рабо&shy;тает с одними и теми же дан&shy;ными и код выпол&shy;ня&shy;ется со ско&shy;ростью, ниже чем если бы расчёты шли на одном ядре. Именно поэ&shy;тому раз&shy;дача ядер пото&shy;кам идёт +=2 в слу&shy;чае Hyper&shy;-Threading&shy;. Т.е. про&shy;пус&shy;кая пар&shy;ные ядра.</p>
<div class="paragraph-right-side">03</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">04</div>
<p>В этом слу&shy;чае воз&shy;ни&shy;кает бло&shy;ки&shy;ровка сов&shy;мест&shy;ного дос&shy;тупа: хоть и идёт эму&shy;ля&shy;ция двух ядер, на самом-то деле оно одно. Одни и те же про&shy;цес&shy;сор&shy;ные кэши, вклю&shy;чая кэш записи. Поэ&shy;тому в наихуд&shy;шем сце&shy;на&shy;рии эти потоки испол&shy;ня&shy;ются по оче&shy;реди, а не парал&shy;лельно.</p>
<div class="paragraph-right-side">04</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">05</div>
<p>Так, если про&shy;цес&shy;сор ничего не знает о пото&shy;ках, как же дос&shy;ти&shy;га&shy;ется парал&shy;лель&shy;ное испол&shy;не&shy;ние пото&shy;ков на каж&shy;дом из его ядер? Как было ска&shy;зано, поток  &mdash;  сред&shy;ство опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы выпол&shy;нять на одном про&shy;цес&shy;соре нес&shy;колько задач однов&shy;ре&shy;менно. Дос&shy;ти&shy;га&shy;ется парал&shy;ле&shy;лизм очень быст&shy;рым перек&shy;лю&shy;че&shy;нием между пото&shy;ками в тече&shy;ние очень корот&shy;кого про&shy;ме&shy;жутка вре&shy;мени. Пос&shy;ле&shy;до&shy;ва&shy;тельно запус&shy;кая на выпол&shy;не&shy;ние код каж&shy;дого из пото&shy;ков и делая это дос&shy;та&shy;точно часто, опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема дос&shy;ти&shy;гает цели: делает их испол&shy;не&shy;ние псев&shy;до&shy;па&shy;рал&shy;лель&shy;ным, но парал&shy;лель&shy;ным с точки зре&shy;ния вос&shy;при&shy;я&shy;тия чело&shy;века. Вто&shy;рое обос&shy;но&shy;ва&shy;ние сущест&shy;во&shy;ва&shy;ния пото&shy;ков  &mdash;  это утверж&shy;де&shy;ние, что прог&shy;рамма не так часто сры&shy;ва&shy;ется в мате&shy;ма&shy;ти&shy;чес&shy;кие расчёты. Чаще всего она вза&shy;и&shy;мо&shy;дей&shy;ствует с окру&shy;жа&shy;ю&shy;щим её миром: раз&shy;лич&shy;ным обо&shy;ру&shy;до&shy;ва&shy;нием. Это и работа с жёстким дис&shy;ком и вывод на экран и работа с кла&shy;ви&shy;а&shy;ту&shy;рой и мышью. Поэ&shy;тому чтобы про&shy;цес&shy;сор не прос&shy;та&shy;и&shy;вал, пока обо&shy;ру&shy;до&shy;ва&shy;ние сде&shy;лает то, чего хочет от него прог&shy;рамма, поток можно на это время уста&shy;но&shy;вить в сос&shy;то&shy;я&shy;ние бло&shy;ки&shy;ровки: ожи&shy;да&shy;ния сиг&shy;нала от опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы, чтобы обо&shy;ру&shy;до&shy;ва&shy;ние сде&shy;лало то, что от него про&shy;сили. А в это время можно зап&shy;ла&shy;ни&shy;ро&shy;вать в работу дру&shy;гие потоки. Прос&shy;тей&shy;ший при&shy;мер этого  &mdash;  вызов метода <code>Console&shy;.Read&shy;Key&shy;()</code>.</p>
<div class="paragraph-right-side">05</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">06</div>
<p>Если заг&shy;ля&shy;нуть в дис&shy;пет&shy;чер задач Windows 10, то можно заме&shy;тить, что в дан&shy;ный момент в вашей сис&shy;теме сущес&shy;твует около 1,5 тысячи пото&shy;ков. И если учесть, что квант на деск&shy;топе равен 20 мс, а ядер, нап&shy;ри&shy;мер, 4, то можно сде&shy;лать пос&shy;пеш&shy;ный вывод, что каж&shy;дый поток полу&shy;чает 20 мс работы 1 раз в 7,5 сек&hellip; На самом деле, конечно же, нет. Эта кар&shy;тина явля&shy;ется отлич&shy;ной иллюст&shy;ра&shy;цией того, что боль&shy;шинство из них нахо&shy;дится в бло&shy;ки&shy;ровке: она все чего-то ждут. Кто-то  &mdash;  ввода поль&shy;зо&shy;ва&shy;теля, кто-то  &mdash;  изме&shy;не&shy;ния клю&shy;чей реес&shy;тра&hellip; В опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;теме сущес&shy;твует очень много при&shy;чин, чтобы что-либо ждать.</p>
<div class="paragraph-right-side">06</div>
</div>
<p>Так что пока одни потоки в бло&shy;ки&shy;ровке, дру&shy;гие  &mdash;  что-то делают.</p>
<h2 id="section-2">Соз&shy;да&shy;ние пото&shy;ков</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">07</div>
<p>Прос&shy;тей&shy;шая фун&shy;к&shy;ция соз&shy;да&shy;ния пото&shy;ков в поль&shy;зо&shy;ва&shy;т&shy;ельском режиме опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы назы&shy;ва&shy;ется <code>Create&shy;Thread</code>. Эта фун&shy;к&shy;ция создаёт поток в теку&shy;щем про&shy;цессе. Вари&shy;ан&shy;тов пара&shy;мет&shy;ри&shy;за&shy;ции <code>Create&shy;Thread</code> очень много и когда мы вызы&shy;ваем <code>new Thread&shy;()</code>, то из нашего .NET кода вызы&shy;ва&shy;ется дан&shy;ная фун&shy;к&shy;ция опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы.</p>
<div class="paragraph-right-side">07</div>
</div>
<p>В эту фун&shy;к&shy;цию пере&shy;да&shy;ются сле&shy;ду&shy;ю&shy;щие атри&shy;буты:</p>
<ol>
<li><p><strong>Нео&shy;бя&shy;за&shy;тель&shy;ная струк&shy;тура с атри&shy;бу&shy;тами безо&shy;пас&shy;ности</strong>:</p>
<ul>
<li>Деск&shy;рип&shy;тор безо&shy;пас&shy;ности (SECURITY_ATTRIBUTES) + приз&shy;нак нас&shy;ле&shy;ду&shy;емости деск&shy;рип&shy;тора.</li>
</ul>
<blockquote>
<p>В .NET его нет, но можно соз&shy;дать поток через вызов фун&shy;к&shy;ции опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы;</p>
</blockquote>
</li>
<li><p><strong>Нео&shy;бя&shy;за&shy;тель&shy;ный раз&shy;мер стека</strong>:</p>
<ul>
<li>Началь&shy;ный раз&shy;мер стека, в бай&shy;тах (сис&shy;тема округ&shy;ляет это зна&shy;че&shy;ние до раз&shy;мера стра&shy;ницы памяти)</li>
</ul>
</li>
<li><p>Ука&shy;за&shy;тель на фун&shy;к&shy;цию  &mdash;  точка входа нового пото&shy;ками</p>
</li>
<li><p>Нео&shy;бя&shy;за&shy;тель&shy;ный аргу&shy;мент для пере&shy;дачи дан&shy;ных фун&shy;к&shy;ции потока.</p>
</li>
</ol>
<div class="paragraph-container">
<div class="paragraph-left-side">08</div>
<p>Из того, что мы <strong>не</strong> имеем в .NET явно  &mdash;  это струк&shy;тура безо&shy;пас&shy;ности с атри&shy;бу&shy;тами безо&shy;пас&shy;ности: сей&shy;час мы расс&shy;мат&shy;ри&shy;вать их не будем. Скажу только, что они влияют на воз&shy;мож&shy;ность изме&shy;не&shy;ния инфор&shy;ма&shy;ции о потоке сред&shy;ствами опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы. Остал&shy;ьные пара&shy;метры нам зна&shy;комы и мы, пожа&shy;луй, не будем на них оста&shy;нав&shy;ли&shy;аться.</p>
<div class="paragraph-right-side">08</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">09</div>
<p>Однако, помимо этой фун&shy;к&shy;ции в Windows API сущес&shy;твует ещё одна очень инте&shy;рес&shy;ная фун&shy;к&shy;ция: <code>Create&shy;Remote&shy;Thread</code>, кото&shy;рый создаёт поток в чужом про&shy;цессе. Он часто исполь&shy;зу&shy;ется для мони&shy;то&shy;ринга сос&shy;то&shy;я&shy;ния чужого про&shy;цесса (нап&shy;ри&shy;мер, прог&shy;рамма Snoop&shy;). При помощи этой фун&shy;к&shy;ции при&shy;ло&shy;же&shy;ния .NET могут зали&shy;вать свои потоки в чужие про&shy;цессы, однако тут могут воз&shy;ник&shy;нуть проб&shy;лемы. Пер&shy;вая и самая глав&shy;ная  &mdash;  это отс&shy;утствие в целе&shy;вом потоке .NET runtime. Это зна&shy;чит, что ни одного метода фрейм&shy;ворка там не будет: только Win&shy;API и то, что вы напи&shy;сали сами. Однако, если там .NET есть, то воз&shy;ни&shy;кает вто&shy;рая проб&shy;лема (кото&shy;рой не было раньше). Это  &mdash;  вер&shy;сия runtime. Необ&shy;хо&shy;димо: понять, что там запу&shy;щено (для этого необ&shy;хо&shy;димо импор&shy;ти&shy;ро&shy;вать не-.NET методы runtime, кото&shy;рые напи&shy;саны на C/C++ и разоб&shy;раться, с чем мы имеем дело). На осно&shy;ва&shy;нии полу&shy;чен&shy;ной инфор&shy;ма&shy;ции подг&shy;ру&shy;зить необ&shy;хо&shy;ди&shy;мые вер&shy;сии наших .NET биб&shy;ли&shy;о&shy;тек и каким-то обра&shy;зом пере&shy;дать им управ&shy;ле&shy;ние. Ана&shy;ло&shy;гич&shy;ный фун&shy;кци&shy;о&shy;нал, но для опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы Linux в гото&shy;вом виде не сущес&shy;твует, но ана&shy;ло&shy;гич&shy;ного пове&shy;де&shy;ния всё равно можно добиться. Нап&shy;ри&shy;мер, <a href="https://habr.com/ru/post/473740/">так</a>.</p>
<div class="paragraph-right-side">09</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">10</div>
<p>Я бы реко&shy;мен&shy;до&shy;вал вам поиг&shy;раться с задач&shy;кой такого рода: вжиться в код любого .NET про&shy;цесса и вывести куда-либо сооб&shy;ще&shy;ние об удаче внед&shy;ре&shy;ния (нап&shy;ри&shy;мер, в файл лога).</p>
<div class="paragraph-right-side">10</div>
</div>
<h2 id="section-3">Пла&shy;ни&shy;ро&shy;ва&shy;ние пото&shy;ков</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">11</div>
<p>Для того чтобы пони&shy;мать, в каком порядке испол&shy;нять код раз&shy;лич&shy;ных пото&shy;ков, необ&shy;хо&shy;дима орга&shy;ни&shy;за&shy;ция пла&shy;ни&shy;ро&shy;ва&shy;ния этих пото&shy;ков. Ведь сис&shy;тема может иметь как одно ядро, так и нес&shy;колько. Как иметь эму&shy;ля&shy;цию двух ядер на одном так и не иметь такой эму&shy;ля&shy;ции. И на каж&shy;дом из ядер: желез&shy;ных или же эму&shy;ли&shy;ро&shy;ван&shy;ных необ&shy;хо&shy;димо испол&shy;нять как один поток, так и нес&shy;колько. В конце кон&shy;цов сис&shy;тема может рабо&shy;тать в режиме вир&shy;ту&shy;а&shy;ли&shy;за&shy;ции: в облаке, в вир&shy;ту&shy;альной машине, песоч&shy;нице в рам&shy;ках дру&shy;гой опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы. Поэ&shy;тому мы в обя&shy;за&shy;тель&shy;ном порядке расс&shy;мот&shy;рим пла&shy;ни&shy;ро&shy;ва&shy;ние пото&shy;ков в рам&shy;ках опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы: плат&shy;форма .NET этими воп&shy;ро&shy;сами не зани&shy;ма&shy;ется. Эта инфор&shy;ма&shy;ция  &mdash;  нас&shy;только важ&shy;ная часть мате&shy;ри&shy;ала по мно&shy;го&shy;по&shy;точке, что без его пони&shy;ма&shy;ния мно&shy;го&shy;по&shy;точка не вста&shy;нет на своё место в нашей голове никоим обра&shy;зом.</p>
<div class="paragraph-right-side">11</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">12</div>
<p>Итак, начнём. Орга&shy;ни&shy;за&shy;ция пла&shy;ни&shy;ро&shy;ва&shy;ния в опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;теме Windows явля&shy;ется гиб&shy;рид&shy;ной. С одной сто&shy;роны  &mdash;  моде&shy;ли&shy;ру&shy;ются усло&shy;вия вытес&shy;ня&shy;ю&shy;щей мно&shy;го&shy;за&shy;дач&shy;ности, когда опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема сама решает, когда и на основе каких усло&shy;вия вытес&shy;нить потоки (пове&shy;де&shy;ние почти во всех при&shy;ло&shy;же&shy;ниях). С дру&shy;гой сто&shy;роны  &mdash;  коо&shy;пе&shy;ра&shy;тив&shy;ной мно&shy;го&shy;за&shy;дач&shy;ности, когда потоки сами решают, когда они всё сде&shy;лали и можно перек&shy;лю&shy;чаться на сле&shy;ду&shy;ю&shy;щий (UMS пла&shy;ни&shy;ров&shy;щик, соз&shy;да&shy;ва&shy;е&shy;мый поль&shy;зо&shy;ва&shy;т&shy;ельским кодом вруч&shy;ную. Испол&shy;ьз&shy;уе&shy;тся крайне редко). Режим вытес&shy;ня&shy;ю&shy;щей мно&shy;го&shy;за&shy;дач&shy;ности рабо&shy;тает на основе при&shy;о&shy;ри&shy;те&shy;тов: пла&shy;ни&shy;ров&shy;щик решает, какой сле&shy;ду&shy;ю&shy;щий поток будет испол&shy;няться именно на основе их при&shy;о&shy;ри&shy;те&shy;тов. А вытес&shy;ня&shy;ю&shy;щей потому, что если воз&shy;ни&shy;кает более при&shy;о&shy;ри&shy;тет&shy;ный поток, он вытес&shy;няет тот, кото&shy;рый сей&shy;час испол&shy;нялся. Однако, забе&shy;гая вперёд, можно сде&shy;лать пос&shy;пеш&shy;ный вывод, что во мно&shy;гих слу&shy;чаях это бы озна&shy;чало, что часть пото&shy;ков из-за их низ&shy;ких при&shy;о&shy;ри&shy;те&shy;тов никогда не добе&shy;рется до испол&shy;не&shy;ния. Поэ&shy;тому в опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;теме есть много меха&shy;ник, поз&shy;во&shy;ля&shy;ю&shy;щих пото&shy;кам, кото&shy;рым необ&shy;хо&shy;димо время на испол&shy;не&shy;ние его полу&shy;чить нес&shy;мотря на свой более низ&shy;кий по срав&shy;не&shy;нию с осталь&shy;ными, при&shy;о&shy;ри&shy;тет.</p>
<div class="paragraph-right-side">12</div>
</div>
<h3 id="section-4">Уровни при&shy;о&shy;ри&shy;тета</h3>
<div class="paragraph-container">
<div class="paragraph-left-side">13</div>
<p><img src="https://habrastorage.org/webt/my/cd/zj/mycdzj-0dxto8-mlmt8h_zb50mu.jpeg" alt="Уровни при&shy;о&shy;ри&shy;тета" /></p>
<div class="paragraph-right-side">13</div>
</div>
<p>Windows имеет 32 уровня при&shy;о&shy;ри&shy;тета (0-31):</p>
<ul>
<li>1 уро&shy;вень (00 - 00)  &mdash;  это Zero Page Thread&shy;;</li>
<li>15 уров&shy;ней (01 - 15)  &mdash;  обыч&shy;ные дина&shy;ми&shy;чес&shy;кие при&shy;о&shy;ри&shy;теты;</li>
<li>16 уров&shy;ней (16 - 31)  &mdash;  реал&shy;ьного вре&shy;мени.</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">14</div>
<p>Самый низ&shy;кий при&shy;о&shy;ри&shy;тет имеет <code>Zero Page Thread</code>. Это  &mdash;  спе&shy;ци&shy;альный поток опе&shy;ра&shy;ци&shy;он&shy;ной сис&shy;темы, кото&shy;рый обну&shy;ляет стра&shy;ницы опе&shy;ра&shy;тив&shy;ной памяти, вычи&shy;щая тем самым дан&shy;ные, кото&shy;рые там нахо&shy;ди&shy;лись, но более не нужны, т.к. стра&shy;ница была осво&shy;бож&shy;дена. Необ&shy;хо&shy;димо это по одной прос&shy;той при&shy;чине: когда при&shy;ло&shy;же&shy;ние осво&shy;бож&shy;дает память, оно может нена&shy;ро&shy;ком отдать кому-то чувс&shy;твит&shy;ельные дан&shy;ные. Лич&shy;ные дан&shy;ные, пароли, что-то ещё. Поэ&shy;тому как опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема так и runtime язы&shy;ков прог&shy;рам&shy;ми&shy;ро&shy;ва&shy;ния (а у нас  &mdash;  .NET CLR) обну&shy;ляют полу&shy;ча&shy;е&shy;мые учас&shy;тки памяти. Если опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема пони&shy;мает, что заняться особо нечем: потоки либо стоят в бло&shy;ки&shy;ровке в ожи&shy;да&shy;нии чего-либо либо нет пото&shy;ков, кото&shy;рые испол&shy;ня&shy;ются, то она запус&shy;кает самый низко при&shy;о&shy;ри&shy;тет&shy;ный поток: поток обну&shy;ле&shy;ния памяти. Если она не добе&shy;рется этим пото&shy;ком до каких-либо участ&shy;ков, не страшно: их обну&shy;лят по тре&shy;бо&shy;ва&shy;нию. Когда их зап&shy;ро&shy;сят. Но если есть время, почему бы это не сде&shy;лать зара&shy;нее?</p>
<div class="paragraph-right-side">14</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">15</div>
<p>Про&shy;дол&shy;жая гово&shy;рить о том, что к нам не отно&shy;сится, стоит отме&shy;тить при&shy;о&shy;ри&shy;теты реал&shy;ьного вре&shy;мени, кото&shy;рые когда-то дав&shy;ным-давно тако&shy;выми явля&shy;лись, но быс&shy;тро поте&shy;ряли свой ста&shy;тус при&shy;о&shy;ри&shy;те&shy;тов реал&shy;ьного вре&shy;мени и от этого ста&shy;туса оста&shy;лось лишь наз&shy;ва&shy;ние. Дру&shy;гими сло&shy;вами, Real Time при&shy;о&shy;ри&shy;теты на самом деле не явля&shy;ются тако&shy;выми. Они явля&shy;ются при&shy;о&shy;ри&shy;те&shy;тами с исклю&shy;чи&shy;тельно высо&shy;ким зна&shy;че&shy;нием при&shy;о&shy;ри&shy;тета. Т.е. если опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема будет по какой-то при&shy;чине повы&shy;шать при&shy;о&shy;ри&shy;тет потока с при&shy;о&shy;ри&shy;те&shy;том из дина&shy;ми&shy;чес&shy;кой группы (об этом  &mdash;  позже, но, нап&shy;ри&shy;мер, потому, что потоку осво&shy;бо&shy;дили бло&shy;ки&shy;ровку) и при этом зна&shy;че&shy;ние до повы&shy;ше&shy;ния было равно <code>15</code>, то повы&shy;сить при&shy;о&shy;ри&shy;тет опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема не смо&shy;жет: сле&shy;ду&shy;ю&shy;щее зна&shy;че&shy;ние равно <code>16</code>, а оно  &mdash;  из диа&shy;па&shy;зона реал&shy;ьного вре&shy;мени. Туда повы&shy;шать такими вот &laquo;тви&shy;ками&raquo; нельзя.</p>
<div class="paragraph-right-side">15</div>
</div>
<h2 id="windows-api">Уро&shy;вень при&shy;о&shy;ри&shy;те&shy;тов <strong>про&shy;цес&shy;сов</strong> с пози&shy;ции Windows API</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">16</div>
<p>При&shy;о&shy;ри&shy;теты  &mdash;  штука отно&shy;си&shy;тель&shy;ная. И чтобы нам всем было проще в них ори&shy;ен&shy;ти&shy;ро&shy;ваться, были вве&shy;дены некие пра&shy;вила отно&shy;си&shy;тель&shy;ности рас&shy;че&shy;тов: во-пер&shy;вых все потоки вообще (от всех при&shy;ло&shy;же&shy;ний) равны для пла&shy;ни&shy;ров&shy;щика: пла&shy;ни&shy;ров&shy;щик не раз&shy;ли&shy;чает потоки это раз&shy;лич&shy;ных при&shy;ло&shy;же&shy;ний или же одного и того же при&shy;ло&shy;же&shy;ния. Далее, когда прог&shy;рам&shy;мист пишет свою прог&shy;рамму, он задаёт при&shy;о&shy;ри&shy;тет для раз&shy;лич&shy;ных пото&shy;ков, соз&shy;да&shy;вая тем самым модель мно&shy;го&shy;по&shy;точ&shy;ности внутри сво&shy;его при&shy;ло&shy;же&shy;ния. Он прек&shy;расно знает, почему там был выб&shy;ран пони&shy;жен&shy;ный при&shy;о&shy;ри&shy;тет, а тут  &mdash;  обыч&shy;ный. Внутри при&shy;ло&shy;же&shy;ния всё нас&shy;тро&shy;ено. Далее, пос&shy;кольку есть поль&shy;зо&shy;ва&shy;тель сис&shy;темы, он также может выс&shy;тра&shy;и&shy;вать при&shy;о&shy;ри&shy;теты для при&shy;ло&shy;же&shy;ний, кото&shy;рые запус&shy;ка&shy;ются на этой сис&shy;теме. Нап&shy;ри&shy;мер, он может выб&shy;рать повы&shy;шен&shy;ный при&shy;о&shy;ри&shy;тет для какого-то рас&shy;чет&shy;ного сер&shy;виса, отда&shy;вая ему тем самым мак&shy;си&shy;мум ресур&shy;сов. Т.е. уро&shy;вень при&shy;о&shy;ри&shy;тета можно задать и у про&shy;цесса.</p>
<div class="paragraph-right-side">16</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">17</div>
<p>Однако, изме&shy;не&shy;ние уровня при&shy;о&shy;ри&shy;тета про&shy;цесса не меняет <em>отно&shy;си&shy;тель&shy;ных при&shy;о&shy;ри&shy;те&shy;тов</em> внутри при&shy;ло&shy;же&shy;ния: их зна&shy;че&shy;ния сдви&shy;га&shy;ются, но не меня&shy;ется внут&shy;рен&shy;няя модель при&shy;о&shy;ри&shy;те&shy;тов: внутри по-преж&shy;нему будет поток с пони&shy;жен&shy;ным при&shy;о&shy;ри&shy;те&shy;том и поток  &mdash;  с обыч&shy;ным. Так, как этого хотел раз&shy;ра&shy;бот&shy;чик при&shy;ло&shy;же&shy;ния. Как же это рабо&shy;тает?</p>
<div class="paragraph-right-side">17</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">18</div>
<p>Сущес&shy;твует 6 <em>клас&shy;сов при&shy;о&shy;ри&shy;те&shy;тов</em> про&shy;цес&shy;сов. Класс при&shy;о&shy;ри&shy;те&shy;тов про&shy;цес&shy;сов  &mdash;  это то, отно&shy;си&shy;тельно чего будут соз&shy;да&shy;ваться при&shy;о&shy;ри&shy;теты пото&shy;ков. Все эти классы при&shy;о&shy;ри&shy;те&shy;тов можно уви&shy;деть в &laquo;Дис&shy;пет&shy;чере задач&raquo;, при изме&shy;не&shy;нии при&shy;о&shy;ри&shy;тета какого-либо про&shy;цесса.</p>
<div class="paragraph-right-side">18</div>
</div>
<div class="row">
<div class="offset-3 col-6">
<table>
<thead>
<tr>
<th>Наз&shy;ва&shy;ние</th>
<th>Класс</th>
<th>Базо&shy;вый при&shy;о&shy;ри&shy;тет</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. Real Time</td>
<td>4</td>
<td>24</td>
</tr>
<tr>
<td>2. High</td>
<td>3</td>
<td>13</td>
</tr>
<tr>
<td>3. Above Normal</td>
<td>6</td>
<td>10</td>
</tr>
<tr>
<td>4. Normal</td>
<td>2</td>
<td>8</td>
</tr>
<tr>
<td>5. Below Normal</td>
<td>5</td>
<td>6</td>
</tr>
<tr>
<td>6. Idle</td>
<td>1</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">19</div>
<p>Дру&shy;гими сло&shy;вами класс при&shy;о&shy;ри&shy;тета  &mdash;  это то, отно&shy;си&shy;тельно чего будут зада&shy;ваться при&shy;о&shy;ри&shy;теты пото&shy;ков внутри при&shy;ло&shy;же&shy;ния. Чтобы задать точку отсчёта, было вве&shy;дено поня&shy;тие <em>базо&shy;вого при&shy;о&shy;ри&shy;тета</em>. Базо&shy;вый при&shy;о&shy;ри&shy;тет  &mdash;  это то <strong>зна&shy;че&shy;ние</strong>, чем будет являться при&shy;о&shy;ри&shy;тет потока с типом при&shy;о&shy;ри&shy;тета <strong>Normal</strong>:</p>
<div class="paragraph-right-side">19</div>
</div>
<ul>
<li>Если про&shy;цесс создаётся с <em>клас&shy;сом Normal</em> и внутри этого про&shy;цесса создаётся поток с <em>при&shy;о&shy;ри&shy;те&shy;том Normal</em>, то его <strong>реальный при&shy;о&shy;ри&shy;тет Normal будет равен 8</strong> (строка №4 в таб&shy;лице);</li>
<li>Если Вы создаёте про&shy;цесс и у него <em>класс при&shy;о&shy;ри&shy;тета Above Normal</em>, то <em>базо&shy;вый при&shy;о&shy;ри&shy;тет</em> будет равен 10. Это зна&shy;чит, что потоки внутри этого про&shy;цесса будут соз&shy;да&shy;ваться с более повы&shy;шен&shy;ным при&shy;о&shy;ри&shy;те&shy;том: <strong>Normal будет равен 10</strong>.</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">20</div>
<p>Для чего это необ&shy;хо&shy;димо? Вы как прог&shy;рам&shy;мисты зна&shy;ете модель мно&shy;го&shy;по&shy;точ&shy;ности, кото&shy;рая у вас при&shy;сут&shy;ствует.
Пото&shy;ков может быть много и вы реша&shy;ете, что один поток дол&shy;жен быть фоно&shy;вым, так как он про&shy;из&shy;во&shy;дит вычис&shy;ле&shy;ния и вам
не столь важно, когда дан&shy;ные ста&shy;нут дос&shy;тупны: важно чтобы поток завер&shy;шил вычис&shy;ле&shy;ния (нап&shy;ри&shy;мер поток обхода и ана&shy;лиза дерева). Поэ&shy;тому, вы уста&shy;нав&shy;ли&shy;ва&shy;ете пони&shy;жен&shy;ный при&shy;о&shy;ри&shy;тет дан&shy;ного потока. Ана&shy;ло&shy;гично может сло&shy;жится ситу&shy;а&shy;ция когда необ&shy;хо&shy;димо запус&shy;тить поток с повы&shy;шен&shy;ным при&shy;о&shy;ри&shy;те&shy;том.</p>
<div class="paragraph-right-side">20</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">21</div>
<p>Предс&shy;та&shy;вим, что ваше при&shy;ло&shy;же&shy;ние запус&shy;кает поль&shy;зо&shy;ва&shy;тель и он решает, что ваше при&shy;ло&shy;же&shy;ние пот&shy;реб&shy;ляет слиш&shy;ком много про&shy;цес&shy;сор&shy;ных ресур&shy;сов. Поль&shy;зо&shy;ва&shy;тель счи&shy;тает, что ваше при&shy;ло&shy;же&shy;ние не столь важ&shy;ное в сис&shy;теме, как какие-нибудь дру&shy;гие при&shy;ло&shy;же&shy;ния и пони&shy;жает при&shy;о&shy;ри&shy;тет вашего при&shy;ло&shy;же&shy;ния до Below Normal&shy;. Это озна&shy;чает, что он задаёт базо&shy;вый при&shy;о&shy;ри&shy;тет 6 отно&shy;си&shy;тельно кото&shy;рого будут расс&shy;чи&shy;ты&shy;ваться при&shy;о&shy;ри&shy;теты пото&shy;ков внутри вашего при&shy;ло&shy;же&shy;ния. Но в сис&shy;теме общий при&shy;о&shy;ри&shy;тет упадёт. Как при этом меня&shy;ются при&shy;о&shy;ри&shy;теты пото&shy;ков внутри при&shy;ло&shy;же&shy;ния?</p>
<div class="paragraph-right-side">21</div>
</div>
<div class="row">
<div class="offset-3 col-6">
<table>
<thead>
<tr>
<th></th>
<th>Уровни насы&shy;ще&shy;ния</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. Time Critical</td>
<td>(+15)</td>
</tr>
<tr>
<td>2. Higest</td>
<td>(+2)</td>
</tr>
<tr>
<td>3. Above normal</td>
<td>(+1)</td>
</tr>
<tr>
<td>4. Normal</td>
<td>(+0)</td>
</tr>
<tr>
<td>5. Below normal</td>
<td>(-1)</td>
</tr>
<tr>
<td>6. Lowest</td>
<td>(-2)</td>
</tr>
<tr>
<td>7. Idle</td>
<td>(-15)</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><em>Таб&shy;лица 3</em></p>
<div class="paragraph-container">
<div class="paragraph-left-side">22</div>
<p>Normal остаётся на уровне +0 отно&shy;си&shy;тельно уровня базо&shy;вого при&shy;о&shy;ри&shy;тета про&shy;цесса. Below normal  &mdash;  это (-1) отно&shy;си&shy;тельно уровня базо&shy;вого. Т.е. в нашем при&shy;мере с пони&shy;же&shy;нием уровня при&shy;о&shy;ри&shy;тета про&shy;цесса до класса <code>Below Normal</code> при&shy;о&shy;ри&shy;тет потока &lsquo;Below Normal&rsquo; перес&shy;чи&shy;та&shy;ется и будет не <code>8 - 1 = 7</code> (каким он был при классе <code>Normal</code>), а  <code>6 - 1 = 5</code>.  Lowest (-2) ста&shy;нет рав&shy;ным <code>4</code>.</p>
<div class="paragraph-right-side">22</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">23</div>
<p><code>Idle</code> и <code>Time Critical</code>  &mdash;  это уровни насы&shy;ще&shy;ния (-15 и +15). Почему Normal  &mdash;  это <code>0</code> и отно&shy;си&shy;тельно него всего два шага: -2, -1, +1 и +2? Легко про&shy;вести парал&shy;лель с обу&shy;че&shy;нием. Мы ходим в школу, полу&shy;чаем оценки наших зна&shy;ний (5,4,3,2,1) и нам понятно, что это за оценки: 5  &mdash;  моло&shy;дец, 4  &mdash;  хорошо, 3  &mdash;  вообще не пос&shy;та&shy;рался, 2  &mdash;  это не делал ни чего, а 1  &mdash;  это то, что можно испра&shy;вить потом на 4. Но если у нас вво&shy;дится 10-ти баль&shy;ная сис&shy;тема оце&shy;нок (или что вообще ужас  &mdash;  100-баль&shy;ная), то воз&shy;ни&shy;кает неяс&shy;ность: что такое 9 бал&shy;лов или 7? Как понять, что вам пос&shy;та&shy;вили 3 или 4?</p>
<div class="paragraph-right-side">23</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">24</div>
<p>Тоже самое и с при&shy;о&shy;ри&shy;те&shy;тами. У нас есть Normal&shy;. Дальше, отно&shy;си&shy;тельно Normal у нас есть чуть повыше
Normal (Normal above), чуть пониже Normal (Normal below). Также есть шаг на два вверх
или на два вниз (Higest и Lowest&shy;). Нам, поверьте, нет ника&shy;кой необ&shy;хо&shy;ди&shy;мости в более под&shy;роб&shy;ной гра&shy;да&shy;ции. Един&shy;ствен&shy;ное, очень редко, может раз в жизни, нам пона&shy;до&shy;бится ска&shy;зать: выше чем любой при&shy;о&shy;ри&shy;тет в сис&shy;теме. Тогда мы выс&shy;тав&shy;ляем уро&shy;вень <code>Time Critical</code>. Либо нао&shy;бо&shy;рот: это надо делать, когда во всей сис&shy;теме делать нечего. Тогда мы выс&shy;тав&shy;ляем уро&shy;вень <code>Idle</code>. Это зна&shy;че&shy;ния  &mdash;  так назы&shy;ва&shy;е&shy;мые уровни насы&shy;ще&shy;ния.</p>
<div class="paragraph-right-side">24</div>
</div>
<h2 id="section-5">Как расс&shy;чи&shy;ты&shy;ва&shy;ются уровни при&shy;о&shy;ри&shy;тета?</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">25</div>
<p><img src="https://habrastorage.org/webt/rj/g2/qw/rjg2qw_-o8amgolaaxvh-sfzx-g.jpeg" alt="Уровни при&shy;о&shy;ри&shy;тета" /></p>
<div class="paragraph-right-side">25</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">26</div>
<p>У нас бал класс при&shy;о&shy;ри&shy;тета про&shy;цесса Normal (Таб&shy;лица 3) и при&shy;о&shy;ри&shy;тет пото&shy;ков Normal  &mdash;  это 8. Если про&shy;цесс Above Normal то поток Normal полу&shy;ча&shy;ется равен 9. Если же про&shy;цесс выс&shy;тав&shy;лен в Higest&shy;, то поток Normal полу&shy;ча&shy;ется равен 10.</p>
<div class="paragraph-right-side">26</div>
</div>
<p>Пос&shy;кольку для пла&shy;ни&shy;ров&shy;щика пото&shy;ков Windows все потоки про&shy;цес&shy;сов рав&shy;ноз&shy;начны, то:</p>
<ul>
<li>Для про&shy;цесса класса Normal и потока Above&shy;-Normal&shy;;</li>
<li>Для про&shy;цесса класса Higest и потока Normal&shy;.</li>
</ul>
<p>конеч&shy;ные при&shy;о&shy;ри&shy;теты будут оди&shy;на&shy;ко&shy;выми и равны 10.</p>
<div class="paragraph-container">
<div class="paragraph-left-side">27</div>
<p>Если мы имеем два про&shy;цесса: один с при&shy;о&shy;ри&shy;те&shy;том Normal&shy;, а вто&shy;рой  &mdash;  с при&shy;о&shy;ри&shy;те&shy;том Higest&shy;, но при этом пер&shy;вый имел поток Higest а вто&shy;рой Normal&shy;, то сис&shy;тема их при&shy;о&shy;ри&shy;теты будет расс&shy;мат&shy;ри&shy;вать как оди&shy;на&shy;ко&shy;вые.</p>
<div class="paragraph-right-side">27</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">28</div>
<p>Как уже обсуж&shy;да&shy;лось, группа при&shy;о&shy;ри&shy;те&shy;тов Real&shy;-Time на самом деле не явля&shy;ется тако&shy;вой, пос&shy;кольку нас&shy;то&shy;я&shy;щий Real&shy;-Time  &mdash;  это гаран&shy;ти&shy;ро&shy;ван&shy;ная дос&shy;тавка сооб&shy;ще&shy;ния за опре&shy;делённое время либо обра&shy;ботка его полу&shy;че&shy;ния. Т.е., дру&shy;гими сло&shy;вами, если на конк&shy;рет&shy;ном ядре есть такой поток, дру&shy;гих там быть не дол&shy;жно. Однако это ведь не так: сис&shy;тема может решить, что низко при&shy;о&shy;ри&shy;тет&shy;ный поток давно не рабо&shy;тал и дать ему время, отклю&shy;чив real-time. Вер&shy;нее его наз&shy;вать клас&shy;сом при&shy;о&shy;ри&shy;те&shy;тов кото&shy;рый рабо&shy;тает над обыч&shy;ными при&shy;о&shy;ри&shy;те&shy;тами и куда обыч&shy;ные при&shy;о&shy;ри&shy;теты не могут уйти, попав под ситу&shy;а&shy;ции, когда Windows вре&shy;менно повы&shy;шает им при&shy;о&shy;ри&shy;тет.</p>
<div class="paragraph-right-side">28</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">29</div>
<p>Но так как поток повы&shy;шен&shy;ным при&shy;о&shy;ри&shy;те&shy;том испол&shy;ня&shy;ется только один на группе ядер, то полу&shy;ча&shy;ется,
что если у вас даже Real&shy;-Time потоки, не факт, что им будет выде&shy;лено время.</p>
<div class="paragraph-right-side">29</div>
</div>
<div class="row">
<div class="offset-2 col-8">
<table>
<thead>
<tr>
<th>Класс при&shy;о&shy;ри&shy;тета / отно&shy;си&shy;тель&shy;ный при&shy;о&shy;ри&shy;тет</th>
<th>Real&shy;-Time</th>
<th>High</th>
<th>Above&shy;-Normal</th>
<th>Normal</th>
<th>Below&shy;-Normal</th>
<th>Idle</th>
</tr>
</thead>
<tbody>
<tr>
<td>Time Critical (+насы&shy;ще&shy;ние)</td>
<td>31</td>
<td>15</td>
<td>15</td>
<td>15</td>
<td>15</td>
<td>15</td>
</tr>
<tr>
<td>Highest (+2)</td>
<td>26</td>
<td>15</td>
<td>12</td>
<td>10</td>
<td>8</td>
<td>6</td>
</tr>
<tr>
<td>Above Normal (+1)</td>
<td>25</td>
<td>14</td>
<td>11</td>
<td>9</td>
<td>7</td>
<td>5</td>
</tr>
<tr>
<td>Normal (0)</td>
<td>24</td>
<td>13</td>
<td>10</td>
<td>8</td>
<td>6</td>
<td>4</td>
</tr>
<tr>
<td>Below Normal (-1)</td>
<td>23</td>
<td>12</td>
<td>9</td>
<td>7</td>
<td>5</td>
<td>3</td>
</tr>
<tr>
<td>Lowest (-2)</td>
<td>22</td>
<td>11</td>
<td>8</td>
<td>6</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>Idle (-насы&shy;ще&shy;ние)</td>
<td>16</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">30</div>
<p>Если пере&shy;вести в гра&shy;фи&shy;чес&shy;кий вид, то можно заме&shy;тить, что классы при&shy;о&shy;ри&shy;те&shy;тов пере&shy;се&shy;ка&shy;ются. Нап&shy;ри&shy;мер, сущес&shy;твует пере&shy;се&shy;че&shy;ние Above&shy;-Normal Normal Below&shy;-Normal (стол&shy;бик с квад&shy;ра&shy;ти&shy;ками):</p>
<div class="paragraph-right-side">30</div>
</div>
<p><img src="https://habrastorage.org/webt/6j/8d/ly/6j8dlyzhce7vzb5pm4ycnfq0bnc.jpeg" alt="" /></p>
<div class="paragraph-container">
<div class="paragraph-left-side">31</div>
<p>Это зна&shy;чит, что для этих трех клас&shy;сов при&shy;о&shy;ри&shy;те&shy;тов про&shy;цес&shy;сов сущес&shy;твуют такие при&shy;о&shy;ри&shy;теты пото&shy;ков внутри этих клас&shy;сов, что реальный при&shy;о&shy;ри&shy;тет будет равен. При этом, когда вы задаёте при&shy;о&shy;ри&shy;тет про&shy;цессу вы просто повы&shy;ша&shy;ете или пони&shy;жа&shy;ете все его внут&shy;рен&shy;ние при&shy;о&shy;ри&shy;теты пото&shy;ков на опре&shy;делённое зна&shy;че&shy;ние (см. Таб&shy;лица 3).</p>
<div class="paragraph-right-side">31</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">32</div>
<p>Поэ&shy;тому, когда про&shy;цессу выдаётся более высо&shy;кий класс при&shy;о&shy;ри&shy;тета, это повы&shy;шает при&shy;о&shy;ри&shy;тет пото&shy;ков про&shy;цесса отно&shy;си&shy;тельно обыч&shy;ных – с клас&shy;сом Normal&shy;.</p>
<div class="paragraph-right-side">32</div>
</div>
<h2 id="section-6">Сос&shy;то&shy;я&shy;ние потока</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">33</div>
<p>Поток в тер&shy;ми&shy;но&shy;ло&shy;гии пла&shy;ни&shy;ро&shy;ва&shy;ния может нахо&shy;диться в нес&shy;коль&shy;ких сос&shy;то&shy;я&shy;ниях, обра&shy;зуя конеч&shy;ный авто&shy;мат, в рам&shy;ках кото&shy;рого рабо&shy;тает поток. Когда создаётся поток, он создаётся в ста&shy;тусе <em>Initi&shy;a&shy;lized</em>. Т.е. он про&shy;и&shy;ни&shy;ци&shy;а&shy;ли&shy;зи&shy;ро&shy;ван и готов к работе. Далее, когда поль&shy;зо&shy;ва&shy;т&shy;ельский код стар&shy;тует поток, тот пере&shy;во&shy;дится в ста&shy;тус <em>Ready</em>. Т.е. готов&shy;ности к испол&shy;не&shy;нию. Дру&shy;гими сло&shy;вами, поток готов к тому, что его в любой момент нач&shy;нут испол&shy;нять на каком-либо про&shy;цес&shy;сор&shy;ном ядре. Спустя неко&shy;то&shy;рое время пла&shy;ни&shy;ров&shy;щик про&shy;сы&shy;па&shy;ется чтобы выб&shy;рать сле&shy;ду&shy;ю&shy;щий к испол&shy;не&shy;нию на теку&shy;щем про&shy;цес&shy;сор&shy;ном ядре поток (для каж&shy;дого ядра соз&shy;да&shy;ется свой пла&shy;ни&shy;ров&shy;щик). Для этого он руко&shy;дос&shy;тву&shy;ется рядом пра&shy;вил: неко&shy;то&shy;рым пото&shy;кам он вре&shy;менно повы&shy;шает при&shy;о&shy;ри&shy;тет (пого&shy;во&shy;рим об этом чуть позже), неко&shy;то&shy;рые нахо&shy;дятся в бло&shy;ки&shy;ровке и поэ&shy;тому не учас&shy;твуют в пла&shy;ни&shy;ро&shy;ва&shy;нии. В любом слу&shy;чае после всех мани&shy;пу&shy;ля&shy;ций он начи&shy;нает выби&shy;рать поток, на кото&shy;рый будет перек&shy;лю&shy;чено теку&shy;щее про&shy;цес&shy;сор&shy;ное ядро из списка гото&shy;вых к испол&shy;не&shy;нию. Т.е. тех, кто в своей машине сос&shy;то&shy;я&shy;ний нахо&shy;дится в сос&shy;то&shy;я&shy;нии <em>Ready</em>.</p>
<div class="paragraph-right-side">33</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">34</div>
<p>Когда пла&shy;ни&shy;ров&shy;щик выб&shy;рал поток, он сни&shy;мает его из оче&shy;реди пото&shy;ков со ста&shy;ту&shy;сом <em>Ready</em> и пере&shy;во&shy;дит его в сос&shy;то&shy;я&shy;ние <em>Standby</em>  &mdash;  неко&shy;то&shy;рое про&shy;ме&shy;жу&shy;точ&shy;ное сос&shy;то&shy;я&shy;ние. После этого пла&shy;ни&shy;ров&shy;щик дол&shy;жен заме&shy;нить актив&shy;ный поток на теку&shy;щем ядре. Для этого он уста&shy;нав&shy;ли&shy;вает сос&shy;то&shy;я&shy;ние регист&shy;ров про&shy;цес&shy;сора в то, каким оно было когда-то на момент пре&shy;ры&shy;ва&shy;ния пла&shy;ни&shy;ров&shy;щи&shy;ком. Тем самым про&shy;цес&shy;сор пере&shy;но&shy;сится в то расчётное сос&shy;то&shy;я&shy;ние, каким оно было на момент пре&shy;ры&shy;ва&shy;ния пла&shy;ни&shy;ро&shy;щи&shy;ком и если при этом вер&shy;нуться на ту инстр&shy;укцию, с кото&shy;рой когда-то прог&shy;рамма была прер&shy;вана и тем самым мы запус&shy;тим поток на испол&shy;не&shy;ние. Но перед таем как окон&shy;ча&shy;тельно запус&shy;тить испол&shy;не&shy;ние потока, пла&shy;ни&shy;ров&shy;щик изме&shy;няет его ста&shy;тус в сос&shy;то&shy;я&shy;ние испол&shy;не&shy;ния <strong>Running</strong>.</p>
<div class="paragraph-right-side">34</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">35</div>
<p>Каж&shy;дому потоку даётся нако&shy;то&shy;рый про&shy;ме&shy;жу&shy;ток вре&shy;мени, в тече&shy;нии кото&shy;рого он может испол&shy;няться прежде чем его прер&shy;вут чтобы отдать время дру&shy;гому. Этот про&shy;ме&shy;жу&shy;ток назы&shy;ва&shy;ется <em>кван&shy;том</em>. Именно бла&shy;го&shy;даря дроб&shy;ле&shy;нию вре&shy;мени на кванты и бла&shy;го&shy;даря тому, что все потоки испол&shy;ня&shy;ются друг за дру&shy;гом (но понем&shy;ногу) и воз&shy;ни&shy;кает иллю&shy;зия парал&shy;лель&shy;ности испол&shy;не&shy;ния прог&shy;рамм. Да, на раз&shy;лич&shy;ных ядрах код испол&shy;ня&shy;ется истинно парал&shy;лельно. Но в рам&shy;ках одного ядра  &mdash;  нет. Именно поэ&shy;тому если ядер у про&shy;цес&shy;сора много, код на ни рабо&shy;тает быс&shy;т&shy;рее.</p>
<div class="paragraph-right-side">35</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">36</div>
<p>Когда же поток отра&shy;ба&shy;ты&shy;вает свой квант вре&shy;мени, пла&shy;ни&shy;ров&shy;щик его пере&shy;во&shy;дит в сос&shy;то&shy;я&shy;ние <em>Ready</em> или <em>Wai&shy;ting</em>.
В сос&shy;то&shy;я&shy;ние <em>Wai&shy;ting</em> поток вхо&shy;дит в том слу&shy;чае, если он вхо&shy;дит бло&shy;ки&shy;ровку (бло&shy;ки&shy;ровки уровня ядра: mutex, semap&shy;hore, работа с дис&shy;ко&shy;вой сис&shy;те&shy;мой ввода/вывода и т.п.). Когда поток нахо&shy;дится в сос&shy;то&shy;я&shy;нии Waiting&shy;, про&shy;цес&shy;сор вообще не тра&shy;тит время на дан&shy;ный поток т.к. он исче&shy;зает из пла&shy;ни&shy;ро&shy;ва&shy;ния: в пла&shy;ни&shy;ро&shy;ва&shy;нии учас&shy;твуют только те потоки, кото&shy;рые к этому готовы. Т.е. нахо&shy;дятся в сос&shy;то&shy;я&shy;нии <em>Ready</em>. После сня&shy;тия бло&shy;ки&shy;ровки поток пере&shy;во&shy;дится в сос&shy;то&shy;я&shy;ние Ready и после того, как до него дохо&shy;дит оче&shy;редь он начи&shy;нает выпол&shy;няться. Сущес&shy;твует допол&shy;ни&shy;тель&shy;ное сос&shy;то&shy;я&shy;ние <em>Tran&shy;si&shy;tion</em>, но мы его расс&shy;мат&shy;ри&shy;вать не будем. И пос&shy;лед&shy;нее сос&shy;то&shy;я&shy;ние: <em>Termi&shy;nated</em>  &mdash;  это когда жизнь потока завер&shy;шена.</p>
<div class="paragraph-right-side">36</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">37</div>
<p>За каж&shy;дым ядром опе&shy;ра&shy;ци&shy;он&shy;ная сис&shy;тема зак&shy;реп&shy;ляет свой пла&shy;ни&shy;ров&shy;щик пото&shy;ков (на кото&shy;ром &laquo;кру&shy;тится&raquo; нес&shy;колько пото&shy;ков). Допус&shy;тим у нас испол&shy;ня&shy;ется 50 пото&shy;ков <strong>на одном ядре</strong>. Квант, выде&shy;ля&shy;е&shy;мый одному потоку около 20 мcек в луч&shy;шем слу&shy;чае. Это зна&shy;чит, что каж&shy;дый поток полу&shy;чит время на испол&shy;не&shy;ние при&shy;мерно 1 раз в <code>50 * 20 = 1000 мсек</code>. <strong>Т.е. один раз в секунду на 20 мcек</strong>. Таким обра&shy;зом, если вы соза&shy;дите боль&shy;шое коли&shy;чес&shy;тво про&shy;цес&shy;сов, в каж&shy;дом из кото&shy;рых будет как мини&shy;мум 1 актив&shy;ный поток, кото&shy;рый не заб&shy;ло&shy;ки&shy;ро&shy;ван ожи&shy;да&shy;нием ввода или вывода, то вы тем самым не просто делите общее время между всеми участ&shy;ни&shy;ками, но и оття&shy;ги&shy;ва&shy;ете сле&shy;ду&shy;ю&shy;щий момент вклю&shy;че&shy;ния потока в работу.</p>
<div class="paragraph-right-side">37</div>
</div>
<p>Двайте обоб&shy;щим.</p>
<p>Сос&shy;то&shy;я&shy;ния пото&shy;ков:</p>
<ul>
<li>Initialized&shy;. Испол&shy;ьз&shy;уе&shy;тся при соз&shy;да&shy;нии потока</li>
<li>Ready&shy;. Готов. Сос&shy;то&shy;я&shy;ние готов&shy;ности, ожи&shy;да&shy;ние выпол&shy;не&shy;ния
<ul>
<li>При поиске сле&shy;ду&shy;ю&shy;щего потока пла&shy;ни&shy;ров&shy;щик расс&shy;мат&shy;ри&shy;вает только это сос&shy;то&shy;я&shy;ние</li>
</ul>
</li>
<li>Deferred Ready&shy;. Готов&shy;ность с отло&shy;жен&shy;ным выпол&shy;не&shy;нием.
<ul>
<li>Поток выб&shy;ран на испол&shy;не&shy;ние на выб&shy;ран&shy;ном про&shy;цес&shy;соре, но ещё не запу&shy;щен.</li>
<li>Для мини&shy;ми&shy;за&shy;ции бло&shy;ки&shy;ровки БД пла&shy;ни&shy;ро&shy;ва&shy;ния</li>
</ul>
</li>
<li>Standby&shy;. В повы&shy;шен&shy;ной готов&shy;ности.
<ul>
<li>Был выб&shy;ран сле&shy;ду&shy;ю&shy;щим для испол&shy;не&shy;ния на конк&shy;рет&shy;ном про&shy;цес&shy;соре</li>
<li>Всё ещё может быть вытес&shy;нен более при&shy;о&shy;ри&shy;тет&shy;ным пото&shy;ком</li>
</ul>
</li>
<li>Running&shy;. Выпол&shy;не&shy;ние
<ul>
<li>Испол&shy;ня&shy;ется до исте&shy;че&shy;ния кванта вре&shy;мени</li>
</ul>
</li>
<li>Wai&shy;ting
<ul>
<li>Ожи&shy;да&shy;ние объ&shy;екта синх&shy;ро&shy;ни&shy;за&shy;ции</li>
<li>ОС ждёт чего-либо от имени потока</li>
</ul>
</li>
<li>Tran&shy;si&shy;tion
<ul>
<li>Если готов к выпол&shy;не&shy;нию, но стек ядра выг&shy;ру&shy;жен из памяти</li>
</ul>
</li>
<li>Terminated&shy;. Завершён</li>
</ul>
<p><img src="./img/2.png" alt="Сос&shy;то&shy;я&shy;ния пото&shy;ков" /></p>
<p>Рису&shy;нок 2: Сос&shy;то&shy;я&shy;ние пото&shy;ков</p>
<p><code>тут пока НЕ обра&shy;бо&shy;тано</code></p>
<div class="paragraph-container">
<div class="paragraph-left-side">38</div>
<p>На рисунке 2 изоб&shy;ра&shy;жено отно&shy;ше&shy;ния пото&shy;ков и про&shy;цес&shy;сора. Откуда видно, что потоки к про&shy;цес&shy;сору не имеют ни какого отнош&shy;к&shy;ния. Для пла&shy;ни&shy;ров&shy;щика пото&shy;ков все они рав&shy;но&shy;ценны.</p>
<div class="paragraph-right-side">38</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">39</div>
<p>Как это всё рабо&shy;тает? Допус&shy;тим мы имеем три про&shy;цесса 1, 2 и 4. Есть две группы ядер со своим пла&shy;ни&shy;ров&shy;щи&shy;ком пото&shy;ков. Есть оче&shy;реди пото&shy;ков по при&shy;о&shy;ри&shy;те&shy;там. И когда поток пла&shy;ни&shy;ру&shy;ется в работу, пере&shy;хо&shy;дит в сос&shy;то&shy;я&shy;ние Ready&shy;, это озна&shy;чает, что он встаёт в опре&shy;делённую оче&shy;редь. Если это поток с при&shy;о&shy;ри&shy;те&shy;том Normal&shy;, запу&shy;щен&shy;ный внутри при&shy;ло&shy;же&shy;ния с Клас&shy;сом Normal будет иметь 8. Зна&shy;чит когда он испол&shy;нится то из Running он перейдёт в Ready и будет пос&shy;тав&shy;лен в оче&shy;редь 8. Если есть потоки кото&shy;рые так-же нахо&shy;дятся в сос&shy;то&shy;я&shy;нии Ready&shy;, но более высо&shy;ких при&shy;о&shy;ри&shy;те&shy;тов, то пла&shy;ни&shy;ров&shy;щик в будет выпол&shy;нять их в пер&shy;вую оче&shy;редь и не будет дохо&shy;дить до вашего потока, пока все потоки с более высо&shy;ким при&shy;о&shy;ри&shy;те&shy;том не будут испол&shy;нены.</p>
<div class="paragraph-right-side">39</div>
</div>
<p><img src="./img/3.png" alt="Вза&shy;и&shy;мо&shy;д&shy;ействие про&shy;цес&shy;сора и пото&shy;ков" /></p>
<p>Рису&shy;нок 2: Потоки и про&shy;цес&shy;сор</p>
<h2 id="section-7">Кванты вре&shy;мени</h2>
<div class="paragraph-container">
<div class="paragraph-left-side">40</div>
<p>Квант  &mdash;  это про&shy;ме&shy;жу&shy;ток вре&shy;мени в тече&shy;ние кото&shy;рого поток будет испол&shy;няться. Каж&shy;дому потоку выде&shy;ля&shy;ется квант вре&shy;мени на испол&shy;не&shy;ние. Потоки рабо&shy;тают через и в тече&shy;ние опре&shy;делённого коли&shy;чес&shy;тво вре&shy;мени. Между пото&shy;ками есть про&shy;ме&shy;жутки вре&shy;мени, во время кото&shy;рых пла&shy;ни&shy;ров&shy;щик пото&shy;ков выпол&shy;няет свою работу.</p>
<div class="paragraph-right-side">40</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">41</div>
<p>На одноп&shy;ро&shy;цес&shy;сор&shy;ной сис&shy;теме x86 работа ситем&shy;ного тай&shy;мера нас&shy;тро&shy;ена на сра&shy;ба&shy;ты&shy;вает каж&shy;дые 10 млСек, тем самым воз&shy;ни&shy;кает аппа&shy;рат&shy;ное пре&shy;ры&shy;ва&shy;ние про&shy;цес&shy;сора INT 08 и вызов фун&shy;к&shy;ции поль&shy;зо&shy;ва&shy;теля. На этом пре&shy;ры&shy;ва&shy;нии уста&shy;нов&shy;лен пла&shy;ни&shy;ров&shy;щик. На мно&shy;гоп&shy;ро&shy;цес&shy;сор&shy;ной сис&shy;теме тай&shy;мер нас&shy;троен на 15 млСек.</p>
<div class="paragraph-right-side">41</div>
</div>
<p><img src="./img/4.png" alt="Такты сис&shy;тем&shy;ного тай&shy;мера" /></p>
<p>Рису&shy;нок 3: Потоки и про&shy;цес&shy;сор</p>
<div class="paragraph-container">
<div class="paragraph-left-side">42</div>
<p>Исходя из сис&shy;тем&shy;ного тай&shy;мера воз&shy;ни&shy;кает <strong>кван&shy;то&shy;вая еди&shy;ница</strong> (рис. 4) рав&shy;ная 1/3 этого интер&shy;вала. Далее когда меня&shy;ется поток это зна&shy;че&shy;ние назы&shy;ва&shy;ется <strong>Зна&shy;че&shy;ние Пере&shy;за&shy;пуска Кванта</strong>. Оно раз&shy;лично на раз&shy;ных опе&shy;ра&shy;ци&shy;он&shy;ных сис&shy;те&shy;мах. На кли&shy;е&shy;нтских сис&shy;те&shy;мах Windows оно равно 6. Это зна&shy;чит, что коли&shy;чес&shy;тво кван&shy;то&shy;вых еди&shy;ниц, выде&shy;ля&shy;е&shy;мых потоку, равно 6. Дол&shy;жно пройти два такта ситем&shy;ного тай&shy;мера 20 мл.сек. на одноп&shy;ро&shy;цес&shy;сор&shy;ной сис&shy;теме и 30 мл.сек. на мно&shy;гоп&shy;ро&shy;цес&shy;сор&shy;ной сис&shy;теме (см. рис. 4) и про&shy;и&shy;зойдёт пере&shy;ход к дру&shy;гому потоку.</p>
<div class="paragraph-right-side">42</div>
</div>
<p><img src="./img/5.png" alt="Кван&shy;то&shy;вая еди&shy;ница" /></p>
<p>Рису&shy;нок 4: Кван&shy;то&shy;вая еди&shy;ница</p>
<ul>
<li>Кван&shy;то&shy;вая Цель = [Фак&shy;тич. Кван&shy;то&shy;вые Еди&shy;ницы] * [Так&shy;то&shy;вых Импул&shy;ьсов на квант вре&shy;мени]</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">43</div>
<p>Вре&shy;мен&shy;ная шкала сис&shy;тем&shy;ного тай&shy;мера предс&shy;тав&shy;лена на рисунке 5. Зна&shy;че&shy;ние пере&shy;за&shy;пуска кванта в кли&shy;е&shy;нтских сис&shy;те&shy;мах Windows равно 6 в сер&shy;вер&shy;ных сис&shy;те&shy;мах Windows 36, то есть в шесть раз длин&shy;нее зна&shy;чит поток будет отра&shy;ба&shy;ты&shy;вать 120 мл.сек. После чего он перейдёт в сос&shy;то&shy;я&shy;ние Ready и вернётся к испол&shy;не&shy;нию не скоро. Поэ&shy;тому на сер&shy;вер&shy;ной сис&shy;теме необ&shy;хо&shy;димо остав&shy;лять только те при&shy;ло&shy;же&shy;ния, кото&shy;рые там дол&shy;жны рабо&shy;тать и больше ничего лиш&shy;него.</p>
<div class="paragraph-right-side">43</div>
</div>
<p><img src="./img/6.png" alt="Вре&shy;мен&shy;ная шкала сис&shy;тем&shy;ного тай&shy;мера" /></p>
<p>Рису&shy;нок 5: Вре&shy;мен&shy;ная шкала сис&shy;тем&shy;ного тай&shy;мера</p>
<ul>
<li>Зна&shy;че&shy;ние Пере&shy;за&shy;пуска Кванта = [Фак&shy;тич. Кван&shy;то&shy;вые Еди&shy;ницы] * [Кол-во Квант. Еди&shy;ниц в Такте]
<ul>
<li>= 6 (2 * 3 ) в кли&shy;е&shy;нтских сис&shy;те&shy;мах Windows</li>
<li>= 36 (12 * 3) в сер&shy;вер&shy;ных сис&shy;те&shy;мах Windows</li>
</ul>
</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">44</div>
<p>Пред&shy;по&shy;ло&shy;жим что один из пото&shy;ков на уровне вто&shy;рой кван&shy;то&shy;вой еди&shy;ницы встал в бло&shy;ки&shy;ровку (рис. 6). Этот поток теряет
кван&shy;то&shy;вое время и оно отдаётся дру&shy;гому потоку. Дру&shy;гой поток начал свою работу. Но пос&shy;кольку пла&shy;ни&shy;ров&shy;щик запус&shy;ка&shy;ется только когда сра&shy;ба&shy;ты&shy;вает сис&shy;тем&shy;ный тай&shy;мер, то сле&shy;ду&shy;ю&shy;щий поток отра&shy;бо&shy;тает дольше. Сле&shy;ду&shy;ю&shy;щий поток отра&shy;бо&shy;тает поло&shy;жен&shy;ное время. Полу&shy;ча&shy;ется так, что если вы рабо&shy;та&shy;ете с бло&shy;ки&shy;ров&shy;ками, то ваше при&shy;ло&shy;же&shy;ние будет выпол&shy;няться малое коли&shy;чес&shy;тво вре&shy;мени. Во время работы потока могут воз&shy;ник&shy;нуть аппа&shy;рат&shy;ные пре&shy;ры&shy;ва&shy;ния (INT). Пре&shy;ры&shy;ва&shy;ния это отвле&shy;че&shy;ние про&shy;цес&shy;сора от выпол&shy;не&shy;ния теку&shy;щего потока для выпол&shy;не&shy;ния более важ&shy;ных задач (полу&shy;че&shy;ние сос&shy;то&shy;я&shy;ния внеш&shy;них уст&shy;ройств и т.п.). Обра&shy;ботка пре&shy;ры&shy;ва&shy;ния зани&shy;мает время потока, но вас это не дол&shy;жно бес&shy;по&shy;ко&shy;ить потому, что время зат&shy;ра&shy;чен&shy;ное на обра&shy;ботку пре&shy;ры&shy;ва&shy;ния не учи&shy;ты&shy;ва&shy;ется в пла&shy;ни&shy;ро&shy;ва&shy;нии и соот&shy;ветст&shy;венно ваш поток
отра&shy;бо&shy;тает дольше. Далее, когда поток, осво&shy;бождённый от бло&shy;ки&shy;ровки, про&shy;сы&shy;па&shy;ется, то он дора&shy;ба&shy;ты&shy;вает своё зна&shy;че&shy;ние кван&shy;то&shy;вого пере&shy;за&shy;пуска.</p>
<div class="paragraph-right-side">44</div>
</div>
<p><img src="./img/7.png" alt="Работа потока" /></p>
<p>Рису&shy;нок 6: Работа потока</p>
<div class="paragraph-container">
<div class="paragraph-left-side">45</div>
<p>Давайте опре&shy;де&shy;лим коли&shy;чес&shy;тво кван&shy;то&shy;вых цик&shy;лов на квант. Сог&shy;ласно сле&shy;ду&shy;ю&shy;щих шагов. Шаги нахож&shy;де&shy;ние кван&shy;то&shy;вых цик&shy;лов на квант:</p>
<div class="paragraph-right-side">45</div>
</div>
<ul>
<li>Возьмём так&shy;то&shy;вую час&shy;тоту про&shy;цес&shy;сора:
<ul>
<li>Выпол&shy;ним команду поцес&shy;сора <b>сpuid</b>, кото&shy;рая выдаст точ&shy;ное зна&shy;че&shy;ние час&shy;тоты нашего про&shy;цес&shy;сора в ГГц : Genuine&shy;Intel 2601 fffffff00000000 …</li>
</ul>
</li>
<li>Пере&shy;ведём её в герцы:
<ul>
<li>var freq = 2601 * 1,000,000,000 = 2 601 000 000 так&shy;тов/сек</li>
</ul>
</li>
<li>При помощи ути&shy;литы <b>clockres</b> от Sysin&shy;ter&shy;nals полу&shy;чаем зна&shy;че&shy;ние интер&shy;вала тай&shy;мера в сис&shy;теме (как часто сра&shy;ба&shy;ты&shy;вает тай&shy;мер):
<ul>
<li>15,625 мсек  &mdash;  то есть у нас мно&shy;гоп&shy;ро&shy;цес&shy;сор&shy;ная сис&shy;тема ( 10 мсек  &mdash;  одноп&shy;ро&shy;цес&shy;сор&shy;ная )</li>
</ul>
</li>
<li>Пре&shy;об&shy;ра&shy;зуем его в секунды:
<ul>
<li>15,625 мсек / 1000 = 0,015625 сек</li>
</ul>
</li>
<li>Умно&shy;жим на кол-во цик&shy;лов в секунду и полу&shy;чим число так&shy;тов на интер&shy;вал тай&shy;мера (от &laquo;тика&raquo; до &laquo;тика&raquo; сис&shy;тем&shy;ного тай&shy;мера):
<ul>
<li>2,601,000,000 так&shy;тов/сек  * 0,015625 сек = 32 837 625 так&shy;тов</li>
</ul>
</li>
<li>Полу&shy;чим число так&shy;тов на кван&shy;то&shy;вую еди&shy;ницу (кван&shy;то&shy;вая еди&shy;ница это 1/3 сис&shy;тем&shy;ного тай&shy;мера):
<ul>
<li>32,837,625 / 3 = 10,945,875 так&shy;тов или 0x00A70553</li>
</ul>
</li>
<li>Если вывести дамп пере&shy;мен&shy;ной Ki&shy;Cycles&shy;Per&shy;Clock&shy;Quantum&shy;, полу&shy;чится схо&shy;жее зна&shy;че&shy;ние:
<ul>
<li>lkd> dd nt!Ki&shy;Cycles&shy;Per&shy;Clock&shy;Quantum L1</li>
<li>8149755c 00a70550</li>
</ul>
</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">46</div>
<p>Отно&shy;си&shy;тельно <b>кван&shy;то&shy;вой еди&shy;ницы</b> расс&shy;чи&shy;ты&shy;ва&shy;ется цель. Эта пере&shy;мен&shy;ная при&shy;сут&shy;ствует в сис&shy;теме, но её можно полу&shy;чить только под отлад&shy;чи&shy;ком уровня ядра. Расс&shy;чи&shy;тан&shy;ное нами зна&shy;че&shy;ние прак&shy;ти&shy;чески сов&shy;па&shy;дает со зна&shy;че&shy;нием в сис&shy;теме ( 0x00A70550 ~= 0x00A70553). Ито&shy;го&shy;вые дан&shy;ные для нашего слу&shy;чая предс&shy;тав&shy;лены в  таб&shy;лице 5. Она отоб&shy;ра&shy;жает какое коли&shy;чес&shy;тво так&shy;тов испол&shy;нится в нашем про&shy;цессе, прежде чем он поте&shy;ряет управ&shy;ле&shy;ние.</p>
<div class="paragraph-right-side">46</div>
</div>
<p>Это важно с нес&shy;коль&shy;ких пози&shy;ций.</p>
<ol>
<li>Если есть сер&shy;вер&shy;ное при&shy;ло&shy;же&shy;ние и у нас очень много пото&shy;ков, и они не очень хорошо орга&shy;ни&shy;зо&shy;ваны, то одни потоки будут
&laquo;стра&shy;дать&raquo; из-за дру&shy;гих, если они рабо&shy;тают на одном ядре.</li>
<li>Можно попы&shy;таться прис&shy;во&shy;ить потоки каким-то ядрам и тем самым обес&shy;пе&shy;чить им более дол&shy;гую работу.</li>
<li>Пере&shy;дача про&shy;цес&shy;сор&shy;ного вре&shy;мени дру&shy;гим пото&shy;кам в слу&shy;чае бло&shy;ки&shy;ровки</li>
</ol>
<div class="row">
<div class="offset-3 col-6">
<table>
<thead>
<tr>
<th>Сис&shy;тема</th>
<th>Знач. Пере&shy;за&shy;пуска Кванта</th>
<th>Кван&shy;то&shy;вая Цель (так&shy;тов)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Кли&shy;е&shy;нтская</td>
<td>6</td>
<td>65 675 250</td>
</tr>
<tr>
<td>Сер&shy;вер&shy;ная</td>
<td>36</td>
<td>394 051 500</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3 id="section-8">Управ&shy;ле&shy;ние вели&shy;чи&shy;ной кванта</h3>
<p>Захо&shy;дим в свой&shy;ства сво&shy;его ком&shy;пьютера. Далее &laquo;Change Settings&raquo;</p>
<p><img src="./img/10_1.png" alt="Управ&shy;ле&shy;ние вели&shy;чи&shy;ной кванта. Шаг 1" /></p>
<p>Пере&shy;хо&shy;дим в Perfi&shy;mance -> Settings</p>
<p><img src="./img/10_2.png" alt="Управ&shy;ле&shy;ние вели&shy;чи&shy;ной кванта. Шаг 2" /></p>
<div class="paragraph-container">
<div class="paragraph-left-side">47</div>
<p>Пере&shy;хо&shy;дим на вкладку Advanced&shy;. Prog&shy;rams  &mdash;  это корот&shy;кие кванты (6). Почему для Desktop у нас выб&shy;рано 6? Потому-что, у нас необ&shy;хо&shy;дима отзыв&shy;чи&shy;вость сис&shy;темы, так как за ком&shy;пьютером рабо&shy;тае поль&shy;зо&shy;ва&shy;тель. Пед&shy;по&shy;ло&shy;жим в Chrome открыто 50 вкла&shy;док. Если у нас будет уста&shy;нов&shy;лен квант рав&shy;ный 36 (сер&shy;вер), то даже пере&shy;ме&shy;ще&shy;ние кур&shy;сора &laquo;мыши&raquo; по экрану будет при&shy;тор&shy;ма&shy;жи&shy;вать из-за того что потоку GUI будет выде&shy;ляться мало вре&shy;мени.</p>
<div class="paragraph-right-side">47</div>
</div>
<p>Опти&shy;ми&shy;за&shy;ция под прог&shy;раммы</p>
<ul>
<li>Испол&shy;ьз&shy;ов&shy;ание корот&shy;ких, пере&shy;мен&shy;ных кван&shy;тов</li>
<li>Режим по-умол&shy;ча&shy;нию для кли&shy;е&shy;нтских Windows&shy;, вклю&shy;чая XBOX, Holo&shy;lens</li>
<li>Можно выб&shy;рать наст&shy;ройку, если сер&shy;вер&shy;ная ОС уста&shy;нов&shy;лена как нас&shy;толь&shy;ная</li>
</ul>
<p>Опти&shy;ми&shy;за&shy;ция под фоно&shy;вые службы</p>
<ul>
<li>Испол&shy;ьз&shy;ов&shy;ание длин&shy;ных, фик&shy;си&shy;ро&shy;ван&shy;ных кван&shy;тов</li>
<li>Режим по-умол&shy;ча&shy;нию для сер&shy;вер&shy;ных Windows</li>
<li>Можно выб&shy;рать наст&shy;ройку, если нас&shy;толь&shy;ная ОС уста&shy;нов&shy;лена как сер&shy;вер&shy;ная</li>
<li>Пос&shy;кольку эффект немед&shy;лен&shy;ный, можно выс&shy;та&shy;вить наст&shy;ройку перед нача&shy;лом расчётов, а после расчётов (нап&shy;ри&shy;мер, утром) – вер&shy;нуть наст&shy;ройки назад</li>
</ul>
<p><img src="./img/10_3.png" alt="Управ&shy;ле&shy;ние вели&shy;чи&shy;ной кванта. Шаг 3" /></p>
<h3 id="section-9">Пере&shy;мен&shy;ные кванты</h3>
<div class="paragraph-container">
<div class="paragraph-left-side">48</div>
<p>Кванты вре&shy;мени бывают не только ста&shy;тич&shy;ные но и пере&shy;мен&shy;ные. Ста&shy;тич&shy;ные кванты это когда в име&shy;ете 6 и 36 не зави&shy;симо от усло&shy;вий (каких усло&shy;вий?). Пере&shy;мен&shy;ные кванты в зави&shy;си&shy;мости от усло&shy;вий вам может быть выде&shy;лено больше про&shy;цес&shy;сор&shy;ного вре&shy;мени на квант. В это усло&shy;вия вхо&shy;дит, нап&shy;ри&shy;мер, при&shy;ло&shy;же&shy;ние кото&shy;рое сей&shy;час нахо&shy;дится на перед&shy;нем плане  &mdash;  оно рабо&shy;тает дольше, чем все осталь&shy;ные. И, соот&shy;ветст&shy;венно, быс&shy;т&shy;рее. При копи&shy;ро&shy;ва&shy;нии фай&shy;лов, если пере&shy;ме&shy;щать кур&shy;сор &laquo;мыши&raquo; над окном, то копи&shy;ро&shy;ва&shy;ние идёт быс&shy;т&shy;рее :) из-за того,  что такие потоки полу&shy;чают вре&shy;менно повы&shy;ше&shy;ние при&shy;о&shy;ри&shy;тета.</p>
<div class="paragraph-right-side">48</div>
</div>
<p>Если раз&shy;ре&shy;шено исполь&shy;зо&shy;ва&shy;ние пере&shy;мен&shy;ных кван&shy;тов (кли&shy;е&shy;нтская ОС):</p>
<ul>
<li>в таб&shy;лицу пере&shy;мен&shy;ных кван&shy;тов заг&shy;ру&shy;жа&shy;ется Psp&shy;Foreground&shy;Quantum&shy;, кото&shy;рая исполь&shy;зу&shy;ется фун&shy;кцией Psp&shy;Compute&shy;Quantum&shy;, заг&shy;ру&shy;жа&shy;ется таб&shy;лица Psp&shy;Variable&shy;Quantums</li>
<li>Алго&shy;ритм под&shy;би&shy;рает под&shy;хо&shy;дя&shy;щий индекс кванта в зави&shy;си&shy;мости от того, рабо&shy;тает про&shy;цесс на перед&shy;нем плане или нет:
<ul>
<li>есть ли в нём поток, вла&shy;де&shy;ю&shy;щий окном перед&shy;него плана или нет?</li>
</ul>
</li>
<li>В паре с пла&shy;ни&shy;ров&shy;щи&shy;ком пото&shy;ков, это даёт повы&shy;ше&shy;ние при&shy;о&shy;ри&shy;тета для этого про&shy;цесса.</li>
</ul>
<div class="paragraph-container">
<div class="paragraph-left-side">49</div>
<p>Запу&shy;щено два каль&shy;ку&shy;ля&shy;тора: пра&shy;вый  &mdash;  актив&shy;ный (на перед&shy;нем плане), левый  &mdash;  фоно&shy;вый.  Есть группы кван&shy;тов: пере&shy;мен&shy;ные и фик&shy;си&shy;ро&shy;ван&shy;ные. И в таб&shy;лице 6 пока&shy;заны индексы этих каль&shy;ку&shy;ля&shy;то&shy;ров. Пра&shy;вый будет иметь индекс 12 или 18, левый  &mdash;  6. На поль&shy;зо&shy;ва&shy;т&shy;ельской Windows уста&shy;нов&shy;лено по умол&shy;ча&shy;нию пере&shy;мен&shy;ное зна&shy;че&shy;ние кванта. На сер&shy;вере, по умол&shy;ча&shy;нию, нет пере&shy;мен&shy;ных кван&shy;тов.</p>
<div class="paragraph-right-side">49</div>
</div>
<p><img src="./img/11_1.png" alt="Рис" /></p>
<div class="row">
<div class="offset-3 col-6">
<table>
<thead>
<tr>
<th>Зна&shy;че&shy;ние</th>
<th>Индекс корот&shy;кого кванта</th>
<th>Индекс длин&shy;ного кванта</th>
</tr>
</thead>
<tbody>
<tr>
<td>Пере&shy;мен&shy;ное</td>
<td>6      12      18</td>
<td>12     24     36</td>
</tr>
<tr>
<td>Фик&shy;си&shy;ро&shy;ван&shy;ное</td>
<td>18      18      18</td>
<td>36     36     36</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="paragraph-container">
<div class="paragraph-left-side">50</div>
<p>Наст&shy;ройка меня&shy;ется в реес&shy;тре. Можно поме&shy;нять сис&shy;тему раз&shy;дачи кван&shy;тов по адресу <code>HKLM\SYSTEM\Current&shy;Control&shy;Set&shy;\Priority&shy;Control</code>.</p>
<div class="paragraph-right-side">50</div>
</div>
<p><img src="./img/12_1.png" alt="Реестр" /></p>
<div class="row">
<div class="offset-3 col-6">
<table>
<thead>
<tr>
<th>4</th>
<th>3 | 2</th>
<th>1 | 0</th>
</tr>
</thead>
<tbody>
<tr>
<td>корот&shy;кие или длин&shy;ные</td>
<td>Пере&shy;мен&shy;ные/фик&shy;си&shy;ро&shy;ван&shy;ные</td>
<td>Раз&shy;нос при&shy;о&shy;ри&shy;те&shy;тов</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Пара&shy;метр поби&shy;тово делится на три зоны.
Корот&shy;кие или длин&shy;ные</p>
<ul>
<li>0 или 3 – корот&shy;кие для кли&shy;ен&shy;с&shy;ких, длин&shy;ные для сер&shy;вер&shy;ных</li>
<li>1 – длин&shy;ные кванты</li>
<li>2 – корот&shy;кие кванты</li>
</ul>
<p>Пере&shy;мен&shy;ные или фик&shy;си&shy;ро&shy;ван&shy;ные</p>
<ul>
<li>0 или 3 – пере&shy;мен&shy;ные для кли&shy;ен&shy;с&shy;ких, фик&shy;си&shy;ро&shy;ван&shy;ные для сер&shy;вер&shy;ных</li>
<li>1 – пере&shy;мен&shy;ные кванты</li>
</ul>
<p>Раз&shy;нос при&shy;о&shy;ри&shy;те&shy;тов</p>
<ul>
<li>0 - 2 – опре&shy;де&shy;ляет при&shy;о&shy;ри&shy;тет&shy;ное раз&shy;де&shy;ле&shy;ние</li>
</ul>
<h2 id="section-10">Выводы</h2>
<ol>
<li>Когда поток вхо&shy;дит в бло&shy;ки&shy;ровку, он перестаёт учавс&shy;твовать в пла&shy;ни&shy;ро&shy;ва&shy;нии.</li>
<li>На одноп&shy;ро&shy;цес&shy;сор&shy;ной сис&shy;теме пла&shy;ни&shy;ров&shy;щик всегда заби&shy;рает поток сверху, поэ&shy;тому он и назы&shy;ва&shy;ется во пер&shy;вых, с при&shy;о&shy;ри&shy;те&shy;тами,
во вто&shy;рых он вытес&shy;ня&shy;ю&shy;щий. Если появ&shy;ля&shy;ется поток с более высо&shy;ким при&shy;о&shy;ри&shy;те&shy;том, то пла&shy;ни&shy;ров&shy;щик вытес&shy;няет испол&shy;ня&shy;е&shy;мый поток
и перек&shy;лю&shy;ча&shy;ется на поток с боль&shy;шим при&shy;о&shy;ри&shy;те&shy;том.</li>
<li>Важно знать, что есть кванты. Квант  &mdash;  это дос&shy;та&shy;точно длин&shy;ная по вре&shy;мени про&shy;це&shy;дура. И неза&shy;ви&shy;симо от того,
пре&shy;ры&shy;ва&shy;ется ли ваш поток, время, кото&shy;рое выде&shy;лено потоку, он отра&shy;бо&shy;тает</li>
<li>Если поток пере&shy;хо&shy;дит в бло&shy;ки&shy;ровку, то часть вре&shy;мени пере&shy;хо&shy;дит дру&shy;гому потоку</li>
</ol>

        </div>
        <footer>
            <div class="footer-container">
                <div class="footer-wrap">
                    <img src="../../../../res/img/logo-w-noindex.svg">
                    <p>
                        <a class="footer-link" target="_blank" href="mailto:sidristij@clrium.ru"><i class="far fa-envelope" aria-hidden="true"></i></a>
                        <a class="footer-link" target="_blank" href="https://vk.com/clrium"><i class="fab fa-vk" aria-hidden="true"></i></a>
                        <a class="footer-link" target="_blank" href="https://youtube.com/clrium"><i class="fab fa-youtube" aria-hidden="true"></i></a>
                        <a class="footer-link" target="_blank" href="https://github.com/clrium"><i class="fab fa-github" aria-hidden="true"></i></a>
                        <a class="footer-link" target="_blank" href="skype:stanislav.sidristyi"><i class="fab fa-skype" aria-hidden="true"></i></a>
                        <a class="footer-link" target="_blank" href="https://t.me/clrium_group"><i class="fab fa-telegram" aria-hidden="true"></i></a>
                    </p>
                </div>
            </div>
        </footer>
    </div>
</body>
</html>